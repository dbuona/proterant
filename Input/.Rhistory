silv.data["pro2"]<-NA
silv.data$pro2[silv.data$silvic_phen_seq== "pro"] <- 1
silv.data$pro2[silv.data$silvic_phen_seq== "pro/syn"] <- 1
silv.data$pro2[silv.data$silvic_phen_seq== "syn"] <- 1
silv.data$pro2[silv.data$silvic_phen_seq== "syn/ser"] <- 0
silv.data$pro2[silv.data$silvic_phen_seq== "ser"] <- 0
silv.data$pro2[silv.data$silvic_phen_seq== "hyst"] <- 0
silv.data$pro2[silv.data$name == "Quercus_laurifolia"] <- 1
###super bio hysteranthy for silvics
silv.data["pro3"]<-NA
silv.data$pro3[silv.data$silvic_phen_seq== "pro"] <- 1
silv.data$pro3[silv.data$silvic_phen_seq== "pro/syn"] <- 0
silv.data$pro3[silv.data$silvic_phen_seq== "syn"] <- 0
silv.data$pro3[silv.data$silvic_phen_seq== "syn/ser"] <- 0
silv.data$pro3[silv.data$silvic_phen_seq== "ser"] <- 0
silv.data$pro3[silv.data$silvic_phen_seq== "hyst"] <- 0
silv.data$pro3[silv.data$name == "Quercus_laurifolia"] <- 1
###super biological hysreanthy
mich.data["pro3"]<-NA
mich.data$pro3[mich.data$Phen.sequence == "pro"] <- 1
mich.data$pro3[mich.data$Phen.sequence == "pro/syn"] <- 0
mich.data$pro3[mich.data$Phen.sequence== "syn"] <- 0
mich.data$pro3[mich.data$Phen.sequence== "syn/ser"] <- 0
mich.data$pro3[mich.data$Phen.sequence== "ser"] <- 0
mich.data$pro3[mich.data$Phen.sequence== "hyst"] <- 0
##super biological for michigan trees
d<-comparative.data(mich.tree,mich.data,name,vcv = TRUE,vcv.dim = 2, na.omit = FALSE)
PhyloPro3<-phylo.d(d,binvar=pro3)
PhyloPro3
###functional phylo.D for suilvics
e<-comparative.data(silv.tree,silv.data,name,vcv = TRUE,vcv.dim = 2, na.omit = FALSE)
PhyloSilv2<-phylo.d(e,binvar=pro2)
PhyloSilv2
PhyloSilv3<-phylo.d(e,binvar=pro3)
PhyloSilv3
#####Centering
mich.data$height_cent<-(mich.data$heigh_height-mean(mich.data$heigh_height))/(2*sd(mich.data$heigh_height))
mich.data$fruit_cent<-(mich.data$fruiting-mean(mich.data$fruiting))/(2*sd(mich.data$fruiting))
mich.data$flo_cent<-(mich.data$flo_time-mean(mich.data$flo_time))/(2*sd(mich.data$flo_time))
mich.data$pol_cent<-(mich.data$pol-mean(mich.data$pol))/(2*sd(mich.data$pol))
mich.data$av_fruit_time_cent<-(mich.data$av_fruit_time-mean(mich.data$av_fruit_time))/(2*sd(mich.data$av_fruit_time))
silv.data$height_cent<-(silv.data$height-mean(silv.data$height))/(2*sd(silv.data$height))
silv.data$fruit_cent<-(silv.data$fruiting-mean(silv.data$fruiting))/(2*sd(silv.data$fruiting))
silv.data$flo_cent<-(silv.data$flower_time-mean(silv.data$flower_time))/(2*sd(silv.data$flower_time))
mich.data<-  mich.data %>% remove_rownames %>% column_to_rownames(var="name")
silv.data<-  silv.data %>% remove_rownames %>% column_to_rownames(var="name")
###uncentered
mich5<-phyloglm(pro~pol+heigh_height+flo_time+fruiting+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5)
beta<-coef(mich5)
hi<-1
lo<-0
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
library(arm)
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
earl<-4
mid<-6
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mich.data$mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta)
)
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mich.data$mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta)
print(mean(delta))
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mich.data$mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
beta<-coef(mich5)
earl<-4
mid<-6
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###centered for comparision between bianry and continuous
mich5cent<-phyloglm(pro~pol+height_cent+flo_cent+fruit_cent+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5cent)
###Functional hysteranthy-centered
beta<-coef(mich5cent)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
View(silv.data)
sil5<-phyloglm(pro~pol+heigh_height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=10,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 50, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 8,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 6,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 4,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 80, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 70, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 60, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 50, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 55, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 60, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 58, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 56, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 57, log.alpha.bound = 2,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 57, log.alpha.bound = 1,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+height+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 56, log.alpha.bound = 1,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height_cent+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
mich5<-phyloglm(pro~pol+height_cent+flo_time+fruiting+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5)
###average predictive comparisons
beta<-coef(mich5)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###for fruiting
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###centered for comparision between bianry and continuous
sil5<-phyloglm(pro~pol+flower_time+height_cent+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
###centered silvics
sil5.cent<-phyloglm(pro~pol+flo_cent+height_cent+fruit_cent+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 60, log.alpha.bound = 4,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(sil5.cent)
summary(sil5)
mich5<-phyloglm(pro~pol+heigh_height+flo_time+fruiting+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5)
###average predictive comparisons
beta<-coef(mich5)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
sil5<-phyloglm(pro~pol+flower_time+height+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
return(list(edge.length,root.edge,diag))
beta<-coef(mich5)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###for fruiting
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###centered for comparision between bianry and continuous
mich5cent<-phyloglm(pro~pol+height_cent+flo_cent+fruit_cent+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5cent)
beta<-coef(mich5cent)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
print(mean(delta)+mean(mich.data$av_fruit_time))*(2*sd(mich.data$av_fruit_time)))
print(mean(delta)+mean(mich.data$av_fruit_time)*(2*sd(mich.data$av_fruit_time))
print(mean(delta)+mean(mich.data$av_fruit_time)*(2*sd(mich.data$av_fruit_time)))
print(mean(delta)+mean(mich.data$av_fruit_time)*(2*sd(mich.data$av_fruit_time)))
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta)+mean(mich.data$av_fruit_time)*(2*sd(mich.data$av_fruit_time)))
beta<-coef(mich5)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
print(mean(delta))
mich5<-phyloglm(pro~pol+heigh_height+flo_time+fruiting+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5)
###average predictive comparisons
beta<-coef(mich5)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###for fruiting
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
sil5<-phyloglm(pro~pol+flower_time+height+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height/10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
silv.data$height10<-silv.data$height/10
View(silv.data)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(sil5)
###centered silvics
sil5.cent<-phyloglm(pro~pol+flo_cent+height_cent+fruit_cent+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 60, log.alpha.bound = 4,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(sil5.cent)
mich.data$height10<-mich.data$heigh_height/10
mich5h<-phyloglm(pro~pol+height10+flo_time+fruiting+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5h)
summary(mich5)
beta<-coef(mich5h)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###for fruiting
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
mich.data$height10<-mich.data$heigh_height-mean(mich.data$heigh_height)
mich5h<-phyloglm(pro~pol+height10+flo_time+fruiting+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5h)
###average predictive comparisons (These are very sensative to adjusting)
beta<-coef(mich5h)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###for fruiting
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
silv.data$height10<-silv.data$height-mean(silv.data$height)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
silv.data$height10<-silv.data$height-mean(silv.data$height)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 120, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 150, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 200, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 1000, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 500, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 300, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
silv.data$height10
mich.data$height10
mich.data$height10<-mich.data$heigh_height/mean(mich.data$heigh_height)
mich5h<-phyloglm(pro~pol+height10+flo_time+fruiting+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5h)
###average predictive comparisons (These are very sensative to adjusting)
beta<-coef(mich5h)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###for fruiting
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
mich.data$height10<-mich.data$heigh_height-mean(mich.data$heigh_height)
mich5h<-phyloglm(pro~pol+height10+flo_time+fruiting+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(mich5h)
###average predictive comparisons (These are very sensative to adjusting)
beta<-coef(mich5h)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###for fruiting
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
silv.data$height10<-silv.data$height-mean(silv.data$height)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 300, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 400, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 400, log.alpha.bound = 4,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 400, log.alpha.bound = 0,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 400, log.alpha.bound = 1,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(sil5)
sil5<-phyloglm(pro~pol+flower_time+height+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 400, log.alpha.bound = 1,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
sil5<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 400, log.alpha.bound = 1,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
beta<-coef(sil5)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$heigh_height+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$heigh_height+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
beta<-coef(mich5h)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$height10+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$height10+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$height10+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$height10+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
summary(sil5)
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)
print(mean(delta))
delta<-invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*earl+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*mid+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)
print(mean(delta))
beta<-coef(sil5)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)
print(mean(delta))
###for fruiting
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*earl+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*mid+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)
print(mean(delta))
beta<-coef(mich5h)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*mich.data$height10+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*mich.data$height10+beta[4]*mich.data$flo_time+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
###for flowering
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$height10+beta[4]*earl+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)-
invlogit(beta[1]+beta[2]*mich.data$pol+beta[3]*mich.data$height10+beta[4]*mid+beta[5]*mich.data$fruiting+beta[6]*mich.data$shade_bin)
print(mean(delta))
summary(mich5h)
sil5h<-phyloglm(pro~pol+flower_time+height10+fruiting+shade_bin,silv.data, silv.tree, method = "logistic_MPLE", btol = 400, log.alpha.bound = 1,
start.beta=NULL, start.alpha=NULL,
boot=50,full.matrix = TRUE)
summary(sil5h)
beta<-coef(sil5h)
hi<-1
lo<-0
###for [pollination syndrome]
delta<-invlogit(beta[1]+beta[2]*hi+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*lo+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)
print(mean(delta))
###for flowering
earl<-4
mid<-5
delta<-invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*earl+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*mid+beta[4]*silv.data$height10+beta[5]*silv.data$fruiting+beta[6]*silv.data$shade_bin)
print(mean(delta))
###centered silvics
summer<-8
winter<-10
delta<-invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_timel+beta[4]*silv.data$height10+beta[5]*summer+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silve.data$flower_time+beta[4]*silv.data$height10+beta[5]*winter+beta[6]*silv.data$shade_bin)
delta<-invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_timel+beta[4]*silv.data$height10+beta[5]*summer+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*winter+beta[6]*silv.data$shade_bin)
print(mean(delta))
delta<-invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*summer+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*winter+beta[6]*silv.data$shade_bin)
print(mean(delta))
summer<-9
winter<-10
delta<-invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*summer+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*winter+beta[6]*silv.data$shade_bin)
print(mean(delta))
summer<-10
winter<-11
delta<-invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*summer+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*winter+beta[6]*silv.data$shade_bin)
print(mean(delta))
summer<-8
winter<-11
delta<-invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*summer+beta[6]*silv.data$shade_bin)-
invlogit(beta[1]+beta[2]*silv.data$pol+beta[3]*silv.data$flower_time+beta[4]*silv.data$height10+beta[5]*winter+beta[6]*silv.data$shade_bin)
print(mean(delta))
