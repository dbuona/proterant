set.seed(122)
mich.tree$node.label<-NULL
d<-comparative.data(mich.tree,mich.data,name,vcv = TRUE,vcv.dim = 2, na.omit = FALSE)
PhyloD <- phylo.d(d, binvar=pro) ###regular hysteranthy
PhyloD
plot(PhyloD)
Wind<-phylo.d(d, binvar=pol) #-0.48 more phylogenetically conserved that
Wind
tol<-phylo.d(d, binvar=shade_bin)
tol
plot(Wind)
##functionalhysteranthy
PhyloPro2<-phylo.d(d,binvar=pro2)
PhyloPro2
plot(PhyloPro2)
#d<-comparative.data(mich.tree,mich.data,name,vcv = TRUE,vcv.dim = 2, na.omit = FALSE)
PhyloPro3<-phylo.d(d,binvar=pro3)
PhyloPro3
plot(PhyloPro3)
###phlosignal for continuous trait
?phylosig()
phylosig(mich.tree, mich.data$flo_time, method="lambda", test=TRUE, nsim=999,se=NULL)
phylosig(mich.tree, mich.data$dev.time, method="lambda", test=TRUE, nsim=999)
phylosig(mich.tree, mich.data$heigh_height, method="lambda", test=TRUE, nsim=999)
###Rescale predictors
mich.data$height_cent<-(mich.data$heigh_height-mean(mich.data$heigh_height))/(2*sd(mich.data$heigh_height))
mich.data$fruit_cent<-(mich.data$fruiting-mean(mich.data$fruiting))/(2*sd(mich.data$fruiting))
mich.data$flo_cent<-(mich.data$flo_time-mean(mich.data$flo_time))/(2*sd(mich.data$flo_time))
mich.data$pol_cent<-(mich.data$pol-mean(mich.data$pol))/(2*sd(mich.data$pol))
mich.data$av_fruit_time_cent<-(mich.data$av_fruit_time-mean(mich.data$av_fruit_time))/(2*sd(mich.data$av_fruit_time))
mich.data$dev_time_cent<-(mich.data$dev.time-mean(mich.data$dev.time))/(2*sd(mich.data$dev.time))
mich.data$tol_cent<-(mich.data$shade_bin-mean(mich.data$shade_bin))/(2*sd(mich.data$shade_bin))
###prepare for modeling
mich.data<-  mich.data %>% remove_rownames %>% column_to_rownames(var="name")
mich.data$height10<-mich.data$heigh_height/10
#dev.off()
####
z.funct.seed.winter<-phyloglm(pro2~pol_cent+height_cent+flo_cent+dev_time_cent+tol_cent+pol_cent:flo_cent+dev_time_cent:flo_cent+height_cent:flo_cent+tol_cent:flo_cent,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(z.funct.seed.winter)
bootest<-as.data.frame(z.funct.seed.winter$coefficients)
bootconf<-as.data.frame(z.funct.seed.winter$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="tol_cent"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol_cent"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol_cent:flo_cent"]<-"flower phenology x syndrome "
bootmich$trait[bootmich$trait=="flo_cent:dev_time_cent"]<-"flower phenology x development time"
bootmich$trait[bootmich$trait=="height_cent:flo_cent"]<-"flower phenology x height"
bootmich$trait[bootmich$trait=="flo_cent:tol_cent"]<-"flower phenology x tolerance"
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=1.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,7)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")+ggthemes::theme_few()
functplot
###More plots for understanding interactions
library(sjPlot)
###More plots for understanding interactions
install.packages("sjPlot")
###More plots for understanding interactions
library(sjPlot)
library(sjmisc)
plot_model(z.funct.seed.winter, type = "int")
###More plots for understanding interactions
install.packages("interplot")
###More plots for understanding interactions
library("interplot")
interplot(m = z.funct.seed.winter, var1 = "pol_cent", var2 = "flo_cent")
###More plots for understanding interactions
pairs(z.funct.seed.winter)
###More plots for understanding interactions
plot(z.funct.seed.winter)
###More plots for understanding interactions
plot(mich.data$flo_cent,mich.data$pol_cent)
###More plots for understanding interactions
interaction.plot(mich.data$flo_cent,mich.data$pol_cent)
###More plots for understanding interactions
interaction.plot(mich.data$flo_cent,mich.data$pol_cent,mich.data$pro2)
###More plots for understanding interactions
interaction.plot(mich.data$pol_cent,mich.data$flo_cent,mich.data$pro2)
interaction.plot(mich.data$height_cent,mich.data$flo_cent,mich.data$pro2
interaction.plot(mich.data$height_cent,mich.data$flo_cent,mich.data$pro2
interaction.plot(mich.data$height_cent,mich.data$flo_cent,mich.data$pro2)
###More plots for understanding interactions
interaction.plot(mich.data$pol,mich.data$flo_cent,mich.data$pro2)
###More plots for understanding interactions
interaction.plot(mich.data$pol,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$heigh_height,mich.data$flo_time,mich.data$pro2)
###More plots for understanding interactions
interaction.plot(mich.data$pol,mich.data$flo_time,mich.data$pro2)
###More plots for understanding interactions
interaction.plot(mich.data$pol,mich.data$flo_cent,mich.data$pro2)
###More plots for understanding interactions
interaction.plot(mich.data$pol,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$flo_time,mich.data$heigh_height,mich.data$pro2)
interaction.plot(as.numeric*mich.data$flo_time),as.numeric(mich.data$heigh_height),mich.data$pro2)
interaction.plot(as.numeric(mich.data$flo_time),as.numeric(mich.data$heigh_height),mich.data$pro2)
interaction.plot(as.numeric(mich.data$heigh_height),as.numeric(mich.data$flo_time),mich.data$pro2)
###More plots for understanding interactions
interaction.plot(mich.data$pol,mich.data$flo_time,mich.data$pro2)
plot(mich.data$shade_tol,mich.data$flo_time,mich.data$pro2)
plot(mich.data$shade_bin,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$shade_bin,mich.data$flo_time,mich.data$pro2)
###More plots for understanding interactions
interaction.plot(mich.data$flo_time,mich.data$pol,mich.data$pro2)
###More plots for understanding interactions
interaction.plot(,mich.data$pol,mich.data$flo_time,mich.data$pro2)
###More plots for understanding interactions
interaction.plot(mich.data$pol,mich.data$flo_time,mich.data$pro2)
ction.plot(mich.data$shade_bin,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$shade_bin,mich.data$flo_time,mich.data$pro2)
z.funct.seed.winter$coefficients
z.funct.seed.winter$coefficients[1]
z.funct.seed.winter$coefficients[4]
seq(2,0,1)
seq(0,1,2)
?seq()
seq(0,1,1)
vels<-seq(0,1,1)
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[7]*vels
slopes
plot(levels,slopes)
estmean<-coef(z.funct.seed.winter)
var<-vcov(z.funct.seed.winter)
SEs <- rep(NA, length(vels))
for (i in 1:length(vels)){
j <- vels[i]
SEs[i] <- deltamethod (~ (x4) + (x7)*j, estmean, var)
}
upper <- slopes + 1.96*SEs
lower <- slopes - 1.96*SEs
install.packages("msn")
cbind(vels,slopes)
p<-cbind(vels,slopes)
plot(p$vels,p$slopes)
plot(vels,slopes)
p<-cbind(vels,slopes)
cbind(vels,slopes)
plot(vels, slopes, type = "l", lty = 1, ylim = c(-.1, 1), xlab = "Level of SocSt", ylab = "Marginal Effect of Math")
z.funct.seed.winter$coefficients
mich.data$height_cent
range(mich.data$height_cent)
vels<-seq(-0.5,1.04,0.2)
vels
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[3]*vels
cbind(vels,slopes)
plot(vels, slopes, type = "l", lty = 1, ylim = c(-.1, 1), xlab = "Level of SocSt", ylab = "Marginal Effect of Math")
plot(vels, slopes, type = "l", lty = 1, ylim = c(-.1, 1), xlab = "height", ylab = "Marginal Effect of flowering time")
points(vels, rep(0, length(vels)), type = "l", col = "gray")
plot(vels, slopes, type = "l", lty = 1, ylim = c(-.1, 1), xlab = "height", ylab = "Marginal Effect of flowering time")
points(vels, rep(0, length(vels)), type = "l", col = "gray")
z.funct.seed.winter$coefficients
vels<-seq(0,1,1)
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[7]*vels
cbind(vels,slopes)
plot(vels, slopes, type = "l", lty = 1, ylim = c(-.1, 1), xlab = "syndrome", ylab = "Marginal Effect of flower time")
points(vels, rep(0, length(vels)), type = "l", col = "gray")
rep(0, length(vels))
points(vels, type = "l", col = "gray")
plot(vels, slopes, type = "l", lty = 1, ylim = c(-.1, 1), xlab = "syndrome", ylab = "Marginal Effect of flower time")
points(vels, type = "l", col = "gray")
plot(vels, slopes, type = "l", lty = 1, ylim = c(-3, 3), xlab = "syndrome", ylab = "Marginal Effect of flower time")
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 6), xlab = "syndrome", ylab = "Marginal Effect of flower time")
points(vels, rep(0, length(vels)), type = "l", col = "gray")
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "syndrome", ylab = "Marginal Effect of flower time")
###height
z.funct.seed.winter$coefficients
plot_model(z.funct.seed.winter, type = "int")
###More plots for understanding interactions
interaction.plot(mich.data$pol,mich.data$flo_time,mich.data$pro2)
unique(mich.data$height_cent)
height<-seq(-.33,1.05,0.1)
height
###height
z.funct.seed.winter$coefficients
unique(mich.data$height_cent)
height<-seq(-.33,1.05,0.1)
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[3]*height
cbind(height,slopes)
plot(height, slopes, type = "l", lty = 1, ylim = c(-5, 6), xlab = "height", ylab = "Marginal Effect of flower time")
plot(height, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
View(mich.data)
funct.seed.winter<-phyloglm(pro2~pol+heigh_height+flo_time+dev.time+shade_bin+pol:flo_time+dev.time:flo_time+height_cent:flo_time+shade_bin:flo_time,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
funct.seed.winter<-phyloglm(pro2~pol+height10+flo_time+dev.time+shade_bin+pol:flo_time+dev.time:flo_time+height_cent:flo_time+shade_bin:flo_time,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(z.funct.seed.winter)
####marginal effects of flowering time on pollination
z.funct.seed.winter$lowerbootCI
####marginal effects of flowering time on pollination
z.funct.seed.winter$sd
####marginal effects of flowering time on pollination
z.funct.seed.winter$residuals
funct.seed.winter<-phyloglm(pro2~pol+height10+flo_time+dev.time+shade_bin+pol:flo_time+dev.time:flo_time+height_cent:flo_time+shade_bin:flo_time,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
funct.seed.winter<-phyloglm(pro2~pol+height10+flo_time+dev.time+shade_bin+pol:flo_time+dev.time:flo_time+height_cent:flo_time+shade_bin:flo_time,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=59,full.matrix = TRUE)
summary(funct.seed.winter)
funct.seed.winter<-phyloglm(pro2~pol+heigh_height+flo_time+dev.time+shade_bin+pol:flo_time+dev.time:flo_time+height_cent:flo_time+shade_bin:flo_time,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=59,full.matrix = TRUE)
funct.seed.winter<-phyloglm(pro2~pol+heigh_height+flo_time+dev.time+shade_bin+pol:flo_time+dev.time:flo_time+heigh_height:flo_time+shade_bin:flo_time,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=59,full.matrix = TRUE)
summary(funct.seed.winter)
###height
funct.seed.winter$coefficients
range(mich.data$heigh_height)
height<-seq(.4,1.32,2)
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[3]*height
slopes <- funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[3]*height
cbind(height,slopes)
plot(height, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
plot(height, slopes, type = "l", lty = 1, ylim = c(0, 100), xlab = "height", ylab = "Marginal Effect of flower time")
plot(height, slopes, type = "l", lty = 1, ylim = c(-100, 100), xlab = "height", ylab = "Marginal Effect of flower time")
###height
funct.seed.winter$coefficients
slopes <- funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes)
plot(height, slopes, type = "l", lty = 1, ylim = c(-100, 100), xlab = "height", ylab = "Marginal Effect of flower time")
###height
funct.seed.winter$coefficients
range(mich.data$heigh_height)
height<-seq(.4,1.32,2)
height
height<-seq(.4,32,2)
height
slopes <- funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes)
plot(height, slopes, type = "l", lty = 1, ylim = c(-100, 100), xlab = "height", ylab = "Marginal Effect of flower time")
vels<-seq(0,1,1)
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[7]*vels
cbind(vels,slopes)
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "syndrome", ylab = "Marginal Effect of flower time")
###height
height<-seq(0,30,2)
###height
z.funct.seed.winter$coefficients
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(vels,slopes)
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "syndrome", ylab = "Marginal Effect of flower time")
plot(vels, slopes, type = "l", lty = 1, ylim = c(-20, 20), xlab = "syndrome", ylab = "Marginal Effect of flower time")
height<-seq(0,30,2)
height
plot(vels, slopes, type = "l", lty = 1, ylim = c(-30, 30), xlab = "syndrome", ylab = "Marginal Effect of flower time")
cbind(height,slopes)
plot(height, slopes, type = "l", lty = 1, ylim = c(-30, 30), xlab = "syndrome", ylab = "Marginal Effect of flower time")
mich.data$height_cent
range(mich.data$height_cent)
height<-seq(-0.5603846, 1.0484774,0.2)
height
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes)
plot(height, slopes, type = "l", lty = 1, ylim = c(-3, 3), xlab = "height", ylab = "Marginal Effect of flower time")
plot(height, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "syndrome", ylab = "Marginal Effect of flower time")
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "syndrome", ylab = "Marginal Effect of flower time")
vels<-seq(0,1,1)
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[7]*vels
cbind(vels,slopes)
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "syndrome", ylab = "Marginal Effect of flower time")
plot(height, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
range(mich.data$height_cent)
height<-seq(-0.5603846, 1.0484774,0.2)
slopes2 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
height<-seq(-0.5603846, 1.0484774,0.1)
slopes2 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
range(mich.data$height_cent)
height<-seq(-0.5603846, 1.0484774,0.1)
slopes2 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
interaction.plot(mich.data$class2,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$class,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data2$class,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$class2,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$heigh_height,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$height10,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$heigh_height,mich.data$flo_time,mich.data$pro2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
interaction.plot(mich.data$class2,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$class2,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$class,mich.data$flo_time,mich.data$pro2)
###height
z.funct.seed.winter$coefficients
range(mich.data$height_cent)
height<-seq(-0.5603846, 1.0484774,0.1)
slopes2 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
interaction.plot(mich.data$shade_bin,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$class,mich.data$flo_time,mich.data$pro2)
mich.data$binned_height<-if(0<mich.data$heigh_height<5,1)
mich.data$binned_height<-if(mich.data$heigh_height=>0<5,1)
plot(pro2,mich.data$flo_time)
plot(mich.data$pro2,mich.data$flo_time)
plot(mich.data$pro2,mich.data$flo_time,type=l)
plot(mich.data$pro2,mich.data$flo_time,type="l")
plot(mich.data$pro2,mich.data$flo_time,type="ls")
plot(mich.data$pro2,mich.data$flo_time,type="s")
plot(mich.data$pro2,mich.data$flo_time,type="l")
interaction.plot(mich.data$heigh_height,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$flo_time,mich.data$heigh_height,mich.data$pro2)
interaction.plot(quartile(mich.data$heigh_height),mich.data$flo_time,mich.data$pro2)
interaction.plot(mean(mich.data$heigh_height),mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$heigh_height,mich.data$flo_time,mich.data$pro2)
interaction.plot(mich.data$class,mich.data$flo_time,mich.data$pro2)
qplot(x = pol, y = pro2, data = mich.data, color = flo_time) +
geom_smooth(method = "lm")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = shade_bin, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = tol_cent, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X shade tolerance")
qplot(x = shade_bin, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X shade tolerance")
qplot(x = dev.time, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X shade tolerance")
qplot(x = as.factor(dev.time), y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X shade tolerance")
qplot(x = dev.time, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X shade tolerance")
qplot(x = dev.time, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X development time")
qplot(x = heigh_height y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X development time")
qplot(x = heigh_height y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X development time")
qplot(x = height10 y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X development time")
qplot(x = height_cent y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X height")
qplot(x = height_cent y = pro2, data = mich.data, color = as.factor(flo_time)) +geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X height")
qplot(x = height_cent ,y = pro2, data = mich.data, color = as.factor(flo_time)) +geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X height")
qplot(x = heigh_height ,y = pro2, data = mich.data, color = as.factor(flo_time)) +geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X height")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = as.factor(pol), y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = shade_bin, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X shade tolerance")
qplot(x = pol, y = pro2, data = mich.data, color = flo_time) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = shade_bin, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X shade tolerance")
qplot(x = dev.time, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X development time")
qplot(x = heigh_height ,y = pro2, data = mich.data, color = as.factor(flo_time)) +geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X height")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
binomial_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = as.factor(pol), y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = as.factor(pol), y = as.factor(pro2), data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE), se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = shade_bin, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X shade tolerance")
qplot(x = pol, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X syndrome")
qplot(x = shade_bin, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X shade tolerance")
qplot(x = dev.time, y = pro2, data = mich.data, color = as.factor(flo_time)) +
geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X development time")
qplot(x = heigh_height ,y = pro2, data = mich.data, color = as.factor(flo_time)) +geom_smooth(method = "lm",se=FALSE)+ggtitle("flower time X height")
vels<-seq(0,1,1)
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[7]*vels
cbind(vels,slopes)
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "syndrome", ylab = "Marginal Effect of flower time")
###height
z.funct.seed.winter$coefficients
range(mich.data$height_cent)
height<-seq(-0.5603846, 1.0484774,0.1)
slopes2 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "height", ylab = "Marginal Effect of flower time")
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "height", ylab = "Marginal Effect of flower time")
z.funct.seed.winter$coefficients[4]
z.funct.seed.winter$coefficients[7]
cbind(vels,slopes)
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "syndrome", ylab = "Marginal Effect of flower time")
###height
z.funct.seed.winter$coefficients
range(mich.data$height_cent)
height<-seq(-0.5603846, 1.0484774,0.1)
z.funct.seed.winter$coefficients[4]
z.funct.seed.winter$coefficients[9]
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "height", ylab = "Marginal Effect of flower time")
###height
z.funct.seed.winter$coefficients
fl_time<-seq(3.5m12,0.5)
fl_time<-seq(3.5,12,0.5)
slopes2 <- z.funct.seed.winter$coefficients[3] + z.funct.seed.winter$coefficients[9]*fl_time
cbind(height,slopes2)
cbind(fl_time,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "fltime", ylab = "Marginal Effect of height")
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "fltime", ylab = "Marginal Effect of height")
plot(fl_time, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "fltime", ylab = "Marginal Effect of height")
plot(fl_time, slopes2, type = "l", lty = 1, ylim = c(-30,30), xlab = "fltime", ylab = "Marginal Effect of height")
-0.5603846, 1.0484774
fl_time<-seq(-0.5603846, 1.0484774,0.1)
slopes2 <- z.funct.seed.winter$coefficients[3] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "height", ylab = "Marginal Effect of flower time")
slopes2 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "height", ylab = "Marginal Effect of flower time")
range(mich.data$height_cent)
fl_time<-seq(-0.5603846, 1.0484774,0.1)
###height
z.funct.seed.winter$coefficients
range(mich.data$height_cent)
height<-seq(-0.5603846, 1.0484774,0.1)
slopes2 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-5, 0), xlab = "height", ylab = "Marginal Effect of flower time")
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "height", ylab = "Marginal Effect of flower time")
###shade
z.funct.seed.winter$coefficients
shade<-seq(0.1,1)
slopes3 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[10]*shade
cbind(height,slopes3)
shade<-seq(0,1,1)
slopes3 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[10]*shade
cbind(height,slopes3)
shade<-seq(0,1,1)
slopes3 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[10]*shade
cbind(height,slopes3)
shade
slopes3 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[10]*shade
cbind(shade,slopes3)
plot(shade, slopes3, type = "l", lty = 1, ylim = c(-7, 0), xlab = "shade centered", ylab = "Marginal Effect of flower time")
###height
z.funct.seed.winter$coefficients
range(mich.data$height_cent)
height<-seq(-0.5603846, 1.0484774,0.1)
slopes2 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "height centered", ylab = "Marginal Effect of flower time")
###seed development
z.funct.seed.winter$coefficients
range(mich.data$dev_time_cent)
shade<-seq(-0.7,2.1,0.2)
###seed development
z.funct.seed.winter$coefficients
###seed development
z.funct.seed.winter$coefficients
range(mich.data$dev_time_cent)
seed<-seq(-0.7,2.1,0.2)
slopes4 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[8]*seed
cbind(shade,slopes4)
cbind(seed,slopes4)
plot(seed, slopes4, type = "l", lty = 1, ylim = c(-7, 0), xlab = "shade centered", ylab = "Marginal Effect of flower time")
plot(seed, slopes4, type = "l", lty = 1, ylim = c(-7, 0), xlab = "seed centered", ylab = "Marginal Effect of flower time")
plot(seed, slopes4, type = "l", lty = 1, ylim = c(-7, 2), xlab = "seed centered", ylab = "Marginal Effect of flower time")
vels<-seq(0,1,1)
slopes <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[7]*vels
cbind(vels,slopes)
plot(vels, slopes, type = "l", lty = 1, ylim = c(-5, 0), xlab = "syndrome", ylab = "Marginal Effect of flower time")
###height
z.funct.seed.winter$coefficients
range(mich.data$height_cent)
height<-seq(-0.5603846, 1.0484774,0.1)
slopes2 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[9]*height
cbind(height,slopes2)
plot(height, slopes2, type = "l", lty = 1, ylim = c(-7, 0), xlab = "height centered", ylab = "Marginal Effect of flower time")
###shade
z.funct.seed.winter$coefficients
shade<-seq(0,1,1)
slopes3 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[10]*shade
cbind(shade,slopes3)
plot(shade, slopes3, type = "l", lty = 1, ylim = c(-7, 0), xlab = "shade centered", ylab = "Marginal Effect of flower time")
plot(shade, slopes3, type = "l", lty = 1, ylim = c(-4, 0), xlab = "shade centered", ylab = "Marginal Effect of flower time")
###seed development
z.funct.seed.winter$coefficients
range(mich.data$dev_time_cent)
seed<-seq(-0.7,2.1,0.2)
slopes4 <- z.funct.seed.winter$coefficients[4] + z.funct.seed.winter$coefficients[8]*seed
cbind(seed,slopes4)
plot(seed, slopes4, type = "l", lty = 1, ylim = c(-7, 2), xlab = "seed centered", ylab = "Marginal Effect of flower time")
