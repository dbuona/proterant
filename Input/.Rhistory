Anova(lmer(offset~drought+(1|s_id),data=aln.sub),type=3)
Anova(lmer(flower~drought+(1|s_id),data=aln.sub),type=3)
ggplot(aln.sub,aes(as.factor(drought),offset))+geom_boxplot()+ggtitle("Alnus incana")
ggplot(aln.sub,aes(as.factor(drought),flower))+geom_boxplot()+ggtitle("Alnus incana")
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
setwd("~/Documents/git/proterant/input")
library(tidyverse)
library(rworldmap)
library(lme4)
library(car)
#read in clean data
aln<-read.csv("alnus_delta_hyst.csv",header=TRUE)
frax<-read.csv("fraxinus_delta_hyst.csv",header=TRUE)
aes<-read.csv("aes_delta_hyst.csv",header=TRUE
aes<-read.csv("aes_delta_hyst.csv",header=TRUE)
aes<-read.csv("aes_delta_hyst.csv",header=TRUE)
newmap <- getMap(resolution = "low")
plot(newmap,
xlim = c(0, 20),
ylim = c(40, 55),
asp = 1)
points(aln$lon,aln$lat,col="red")
points(frax$lon,frax$lat,col="blue")
points(15.28300,45.2670,col="green")###gerride of this point
points(aes$lon,aes$lat,col="purple")
aln<-dplyr::filter(aln,lat!=45.2670)
aln.sub<-dplyr::filter(aln,year %in% c(2004,2005,2006,2008,2009,2010))
aln.sub$drought<-ifelse(aln.sub$year %in% c(2004,2005,2006),1,0)
Anova(lmer(offset~drought+(1|s_id),data=aln.sub),type=3)
Anova(lmer(flower~drought+(1|s_id),data=aln.sub),type=3)
ggplot(aln.sub,aes(as.factor(drought),offset))+geom_boxplot()+ggtitle("Alnus incana")
ggplot(aln.sub,aes(as.factor(drought),flower))+geom_boxplot()+ggtitle("Alnus incana")
frax.sub<-dplyr::filter(frax,year %in% c(2004,2005,2006,2008,2009,2010))
frax.sub$drought<-ifelse(frax.sub$year %in% c(2004,2005,2006),1,0)
library(car)
summary(lmer(offset~drought+(1|s_id),data=frax.sub))
summary(lmer(flower~drought+(1|s_id),data=frax.sub))
summary(lmer(flower~drought+(1|s_id),data=frax.sub))
ggplot(frax.sub,aes(as.factor(drought),offset))+geom_boxplot()+ggtitle("Fraxinus excelsior")
ggplot(frax.sub,aes(as.factor(drought),flower))+geom_boxplot()+ggtitle("Fraxinus excelsior")
Anova(lmer(offset~drought+(1|s_id),data=frax.sub))
Anova(lmer(flower~drought+(1|s_id),data=frax.sub))
aes.sub<-dplyr::filter(aes,year %in% c(2004,2005,2006,2008,2009,2010))
aes.sub$drought<-ifelse(aes.sub$year %in% c(2004,2005,2006),1,0)
Anova(lmer(offset~drought+(1|s_id),data=aes.sub))
ggplot(aes.sub,aes(as.factor(drought),offset))+geom_boxplot()+ggtitle("Fraxinus excelsior")
aes.sub<-dplyr::filter(aes,year %in% c(2004,2005,2006,2008,2009,2010))
aes.sub$drought<-ifelse(aes.sub$year %in% c(2004,2005,2006),1,0)
Anova(lmer(offset~drought+(1|s_id),data=aes.sub))
ggplot(aes.sub,aes(as.factor(drought),offset))+geom_boxplot()+ggtitle("Aesculus")
ggplot(aes.sub,aes(as.factor(drought),flower))+geom_boxplot()+ggtitle("Aesculus")
###
install.packages(raster)
###
install.packages("raster")
###
library("raster")
raster(grids_germany_multi_annual_soil_moist_1991-2010_05.asc)
raster("grids_germany_multi_annual_soil_moist_1991-2010_05.asc")
moist<-raster("grids_germany_multi_annual_soil_moist_1991-2010_05.asc")
plot(moist)
coords<-df("lo"=unqiue(c(frax$long))
coords<-df("lo"=unqiue(c(frax$long)))
coords<-df("lo"=unqiue(c(frax$long)))
coords <- data.frame( "lat" = c(frax$lat),"lon" = c(fraqx$lon))
coords <- data.frame( "lat" = c(frax$lat),"lon" = c(frax$lon))
coords <- data.frame( "lat" = c(unique(frax$lat)),"lon" = c(unique(frax$lon)))
coords <- data.frame( "lat" = c(frax$lat),"lon" = c(frax$lon))
library(remote)
install.packages("remote")
library(reshape2)
library("remote")
moist<-raster("grids_germany_multi_annual_soil_moist_1991-2010_05.asc")
plot(moist)
coords <- data.frame( "lat" = c(frax$lat),"lon" = c(frax$lon))
data(moist)
xy<-cbind(frax$lon,frax$lat)
View(xy)
extract(moist, xy)
xy
projection(moist)
extract(moist, matrix(c(3634415,5603501), ncol = 2))
extract(moist, matrix(c(frax$long,frax$lat, ncol = 2))
extract(moist, matrix(c(frax$long,frax$lat, ncol = 2)))
extract(moist, matrix(c(frax$long,frax$lat, ncol = 2)))
extract(moist, matrix(c(xy, ncol = 2)))
xy<-cbind(frax$lon,frax$lat)
View(xy)
unique(xy)
xy<-unique(xy)
extract(moist, matrix(xy, ncol = 2))
extract(moist, matrix(c(xy, ncol = 2)))
extract(moist, matrix(c(xy), ncol = 2))
extract(moist, matrix(cbind(xy), ncol = 2))
xy<-unique(xy)
xy
extract(moist, matrix(c(11.10000 54.5000), ncol = 2))
extract(moist, matrix(c(11.10000 ,54.5000), ncol = 2))
extract(moist, matrix(c(1110000 ,545000), ncol = 2))
moist
newmap
library rgdal
library(rgdal)
cord.dec = SpatialPoints(cbind(xy), proj4string = CRS("+proj=longlat"))
cord.dec
cord.UTM <- spTransform(cord.dec, CRS("+init=epsg:32748"))
cord.UTM
plot(cord.UTM)
extract(moist, matrix(c(cord.UTM), ncol = 2))
cord.UTM
cord.dec
cord.UTM
moist
projection(moist)
xy<-cbind(frax$lon,frax$lat)
xy<-unique(xy)
df.WGS84 <- spTransform(xy, CRS("+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +ellps=bessel +datum=potsdam +units=m +no_defs"))
xy<-df(unique(xy))
xy<-df(unique(xy))
xy<-df("lon"=c(frax$lon),"lat"=c(frax$lat))
xy<-df("lon"=(frax$lon),"lat"=(frax$lat))
xy<-dataset(frax$lon,frax$lat)
xy<-datasets::dataset(frax$lon,frax$lat)
View(coords)
df.WGS84 <- spTransform(coords, CRS("+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +ellps=bessel +datum=potsdam +units=m +no_defs"))
coords<-data.frame(frax$lon,frax$lat)
unique(coords)
xy<-rbind(frax$lon,frax$lat)
coords<-data.frame(frax$lon,frax$lat,xy)
xy<-rbind(frax$lon,frax$lat)
View(coords)
coordinates(coords)<-c(coordinates(df) <- c("frax.lat", "frax.lon"))
coordinates(coords)<- c("frax.lat", "frax.lon"))
coordinates(coords)<- c("frax.lat", "frax.lon")
df.WGS84 <- spTransform(coords, CRS("+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +ellps=bessel +datum=potsdam +units=m +no_defs"))
proj4string(coords) <- CRS("+proj=longlat +datum=WGS84")
p <- spTransform(coords, CRS("+proj=tmerc +lat_0=0 +lon_0=27 +k=1 +x_0=5500000 +y_0=0 +ellps=krass +units=m +no_defs"))
p
plot(p)
plot(moist)
plot(p)
ponts(p)
points(p)
plot(moist)
points(p)
projection(moist)
moist
?spTransform()
?spTransform()
spTransform()
?proj4string()
?proj4string(?)
p <- spTransform(coords, CRS("+proj=tmerc +lat_0=0 +lon_0=15 +k=1 +x_0=3500000 +y_0=0 +ellps=krass +units=m +no_defs"))
points(p)
plot(points(p))
plot(p)
proj4string(coords) <- CRS("+proj=longlat +datum=WGS84")
proj4string(coords) <- CRS("+proj=longlat +datum=WGS84")
coordinates(coords)<
coordinates(coords)
coordinates(coords)
coordinates(coords)<- unique(c("frax.lat", "frax.lon"))
coords<-data.frame(frax$lon,frax$lat)
d<-frax
d<-select(d,lat,lon)
d<-dplyr::select(d,lat,lon)
View(d)
d<-frax
d<-dplyr::select(d,lon,lat)
moist<-raster("grids_germany_multi_annual_soil_moist_1991-2010_05.asc") ##Gause Kruger 3
d<-unite(d,lon,lat,sep="")
View(d)
d<-frax
d<-dplyr::select(d,lon,lat)
d<-unite(d,latlong,lon,lat,sep="")
View(d)
d<-dplyr::select(d,lon,lat)
d<-unite(d,latlong,lon,lat,sep="_")
d<-frax
d<-dplyr::select(d,lon,lat)
d<-unite(d,latlong,lon,lat,sep="_")
d<-dplyr::select(d,lon,lat)
d<-unite(d,latlong,lon,lat,sep=",",remove=FALSE)
d<-frax
d<-dplyr::select(d,lon,lat)
d<-unite(d,latlong,lon,lat,sep=",",remove=FALSE)
d<-!duplicated(d$lonlat)
d<-frax
d<-dplyr::select(d,lon,lat)
d<-unite(d,latlong,lon,lat,sep=",",remove=FALSE)
d<-!duplicated(d)
d<-frax
d<-dplyr::select(d,lon,lat)
d<-unite(d,latlong,lon,lat,sep=",",remove=FALSE)
View(d)
d[!duplicated(d), ]
d<-d[!duplicated(d), ]
coordinates(d)<- unique("lat", "lon")
coordinates(d)<- unique("lon", "lat")
d<-d[!duplicated(d), ]
View(d)
coordinates(d)<- (lon, lat)
coordinates(d)<- ~lon + lat
proj4string(coords) <- CRS("+proj=longlat +datum=WGS84")
d<-frax
d<-dplyr::select(d,lon,lat)
#d<-unite(d,latlong,lon,lat,sep=",",remove=FALSE)
d<-d[!duplicated(d), ]
moist<-raster("grids_germany_multi_annual_soil_moist_1991-2010_05.asc") ##Gause Kruger 3
projection(moist)
coordinates(d)<- ~lon + lat
proj4string(coords) <- CRS("+proj=longlat +datum=WGS84")
proj4string(d) <- CRS("+proj=longlat +datum=WGS84")
p <- spTransform(coords, CRS("+proj=tmerc +lat_0=0 +lon_0=15 +k=1 +x_0=3500000 +y_0=0 +ellps=krass +units=m +no_defs"))
p <- spTransform(d, CRS("+proj=tmerc +lat_0=0 +lon_0=15 +k=1 +x_0=3500000 +y_0=0 +ellps=krass +units=m +no_defs"))
plot(p)
plot(moist)
points(d)
spplot(moist)+spplot(points, col.regions="green")
spplot(moist)
plot(moist)
spplot(moist)
+spplot(points, col.regions="green")
+spplot(d, col.regions="green")
spplot(d, col.regions="green")
points(d)
spplot(p, col.regions="green")
p
moist
p <- spTransform(d, CRS("+proj=tmerc +lat_0=51.29 +lon_0=15 +k=1 +x_0=3500000 +y_0=5684448.397918 +ellps=krass +units=m +no_defs"))
p
plot(moist)
points(d)
plot(d)
plot(moist)+
plot(d)
plot(moist)+plot(d)
gaas<-coordinates(p)
gaas
plot(gaas)
plot(moist)
points(gaas)
moist
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.8 +k=1 +x_0=3559832.734474 +y_0=5610860.187573 +ellps=krass +units=m +no_defs"))
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.8 +k=1 +x_0=3559832.734474 +y_0=5610860.187573 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
plot(moist)
points(gaas)
p <- spTransform(d, CRS("+proj=tmerc +lat_0=52.03125 +lon_0=11.25 +k=1 +x_0=5769312.627544 +y_0=654410.867064 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
plot(moist)
points(gaas)
p <- spTransform(d, CRS("+proj=tmerc +lat_0=52.03125 +lon_0=11.25 +k=1 +x_0=654410.867064 +y_0=5769312.627544 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
plot(moist)
points(gaas)
gaas
p <- spTransform(d, CRS("+proj=tmerc +lat_0=51.29 +lon_0=15 +k=1 +x_0=3500000 +y_0=5684448.397918 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
plot(moist)
points(g)
p <- spTransform(d, CRS("+proj=tmerc +lat_0=51.29 +lon_0=15 +k=1 +x_0=3500000 +y_0=5684448.397918 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
plot(moist)
points(p)
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.84375, +k=1 +x_0=3559832.734474 +y_0=5610860.187573+ellps=krass +units=m +no_defs"))
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.84375, +k=1 +x_0=3559832.734474 +y_0=5610860.187573+ellps=krass +units=m +no_defs"))
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.84375, +k=1 +x_0=3559832.734474 +y_0=5610860.187573 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
plot(moist)
points(p)
install.packages("rdwd")
library(rdwd)
nearbyStations(coordinates(d))
nearbyStations(ccoordinates(d))
?nearbyStations()
?CRS()
?CRS("DHDN_3_Degree_Gauss_Zone_3",GEOGCS["GCS_Deutsches_Hauptdreiecksnetz",DATUM["D_Deutsches_Hauptdreiecksnetz",SPHEROID["Bessel_1841",6377397.155,299.1528128]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Gauss_Kruger"],PARAMETER["False_Easting",3500000.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",9.0],PARAMETER["Scale_Factor",1.0],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]])
CRS("DHDN_3_Degree_Gauss_Zone_3")
CRS("+proj=DHDN_3_Degree_Gauss_Zone_3")
rgdal::CRS("+proj=DHDN_3_Degree_Gauss_Zone_3")
CRS("+proj=Gauss_Kruger")
p <- spTransform(d, CRS("+proj=tmerc +lat_0=0 +lon_0=9.84375, +k=1 +x_0=0 +y_0=5610860.187573 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
plot(moist)
points(p)
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.84375, +k=1 +x_0=3559832.734474 +y_0=5610860.187573 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
plot(moist)
points(p)
p
points(p)
View(p)
coords(p)
coordinates(p)
unique(coordinates(p)0
unique(coordinates(p))
gaas
nrow(gaas)
###decent projectiontry to extract
extract(test, matrix(c(gaas, ncol = 2))
###decent projectiontry to extract
extract(moist, matrix(c(gaas, ncol = 2)))
###decent projectiontry to extract
extract(moist, matrix(c(gaas, ncol = 2)))
###decent projectiontry to extract
extract(moist, matrix(c(gaas), ncol = 2)))
###decent projectiontry to extract
extract(moist, matrix(c(gaas), ncol = 2))
d<-dplyr::select(s_id,d,lon,lat)
d<-frax
d<-dplyr::select(s_id,d,lon,lat)
d<-frax
View(d)
d<-dplyr::select(,d,s_id,lon,lat)
d<-dplyr::select(d,s_id,lon,lat)
#d<-unite(d,latlong,lon,lat,sep=",",remove=FALSE)
d<-d[!duplicated(d), ]
moist<-raster("grids_germany_multi_annual_soil_moist_1991-2010_05.asc") ##Gause Kruger 3
projection(moist)
coordinates(d)<- ~lon + lat
proj4string(d) <- CRS("+proj=longlat +datum=WGS84")
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.84375, +k=1 +x_0=3559832.734474 +y_0=5610860.187573 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
gaas
View(gaas)
goo<-left_join(d,gaas)
goo<-as.data.frame(gaas)
goot<-left_join(d,goo)
View(goo)
class(goo)
class(d)
goo2<-as.data.frame(d)
goot<-left_join(goo2,goo)
View(goot)
d<-frax
d<-dplyr::select(d,s_id,lon,lat)
#d<-unite(d,latlong,lon,lat,sep=",",remove=FALSE)
d<-d[!duplicated(d), ]
moist<-raster("grids_germany_multi_annual_soil_moist_1991-2010_05.asc") ##Gause Kruger 3
coordinates(d)<- ~lon + lat
proj4string(d) <- CRS("+proj=longlat +datum=WGS84")
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.84375, +k=1 +x_0=3559832.734474 +y_0=5610860.187573 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
goo<-as.data.frame(gaas)
goo2<-as.data.frame(d)
View(goo2)
colnames(goo)<-c("x","y")
goot<-left_join(goo2,goo)
goot<-full_join(goo2,goo)
View(goot)
goot<-rbind(goo2,goo)
goot<-cbind(goo2,goo)
View(goot)
d<-frax
d<-dplyr::select(d,s_id,lon,lat)
d<-frax
d<-dplyr::select(d,s_id,lon,lat)
d<-summarise(d,mean.offset=mean(offset))
d<-frax
d %>% group_by(s_id %>% summarise(ave=mean(offset))
d %>% group_by(s_id %>% summarise(ave=mean(offset)
d %>% group_by(s_id %>% summarise(ave=mean(offset)
d %>% group_by(s_id %>% summarise(d,ave=mean(offset)
d<-frax
d %>% group_by(s_id %>% summarise(d,ave=mean(offset)
d %>% group_by(s_id %>% summarise(d,ave=mean(offset))
d %>% group_by(s_id %>% summarise(d,ave=mean(offset))
d %>% group_by(s_id) %>% summarise(d,ave=mean(offset)
d %>% group_by(s_id) %>% summarise(ave=mean(offset)
d %>% group_by(s_id) %>% summarise(ave=mean(offset))
d %>% group_by(s_id) %>% summarise(ave=mean(offset))
calc<-d %>% group_by(s_id) %>% summarise(ave=mean(offset))
d<-dplyr::select(d,s_id,lon,lat)
d<-left_join(d,calc)
View(d)
d<-d[!duplicated(d), ]
View(d)
moist<-raster("grids_germany_multi_annual_soil_moist_1991-2010_05.asc") ##Gause Kruger 3
coordinates(d)<- ~lon + lat
proj4string(d) <- CRS("+proj=longlat +datum=WGS84")
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.84375, +k=1 +x_0=3559832.734474 +y_0=5610860.187573 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
goo<-as.data.frame(gaas)
goo2<-as.data.frame(d)
colnames(goo)<-c("x","y")
class(d)
goot<-cbind(goo2,goo)
View(goot)
###decent projectiontry to extract
extract(moist, matrix(c(gaas), ncol = 2))
###decent projectiontry to extract
foo<-extract(moist, matrix(c(gaas), ncol = 2))
foo
View(foo)
###decent projectiontry to extract
foo<-extract(moist, matrix(c(goot$x,goot$y), ncol = 2))
foo
goot$SM<-foo
View(goot)
lm(offset~SM,data=goot)
lm(offset~SM,data=goot)
class(goot)
?lm()
lm(offset~SM)
lm(offset~goot$SM)
lm(goot$offset~goot$SM)
lm(ave~SM,data=goot)
summary(lm(ave~SM,data=goot))
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
setwd("~/Documents/git/proterant/input")
library(tidyverse)
library(rworldmap)
library(lme4)
library(car)
library(rgdal)
#read in clean data
aln<-read.csv("alnus_delta_hyst.csv",header=TRUE)
frax<-read.csv("fraxinus_delta_hyst.csv",header=TRUE)
aes<-read.csv("aes_delta_hyst.csv",header=TRUE)
newmap <- getMap(resolution = "low")
plot(newmap,
xlim = c(0, 20),
ylim = c(40, 55),
asp = 1)
points(aln$lon,aln$lat,col="red")
points(frax$lon,frax$lat,col="blue")
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
setwd("~/Documents/git/proterant/input")
library(tidyverse)
library(rworldmap)
library(lme4)
library(car)
library(rgdal)
#read in clean data
aln<-read.csv("alnus_delta_hyst.csv",header=TRUE)
frax<-read.csv("fraxinus_delta_hyst.csv",header=TRUE)
aes<-read.csv("aes_delta_hyst.csv",header=TRUE)
newmap <- getMap(resolution = "low")
plot(newmap,
xlim = c(0, 20),
ylim = c(40, 55),
asp = 1)
points(frax$lon,frax$lat,col="blue")
###pretty much all site are in germany except for 1 alnus in croatia
aln<-dplyr::filter(aln,lat!=45.2670)
aln.sub<-dplyr::filter(aln,year %in% c(2004,2005,2006,2008,2009,2010))
aln.sub$drought<-ifelse(aln.sub$year %in% c(2004,2005,2006),1,0)
Anova(lmer(offset~drought+(1|s_id),data=aln.sub),type=3)
Anova(lmer(flower~drought+(1|s_id),data=aln.sub),type=3)
ggplot(aln.sub,aes(as.factor(drought),offset))+geom_boxplot()+ggtitle("Alnus incana")
ggplot(aln.sub,aes(as.factor(drought),flower))+geom_boxplot()+ggtitle("Alnus incana")
frax.sub<-dplyr::filter(frax,year %in% c(2004,2005,2006,2008,2009,2010))
frax.sub$drought<-ifelse(frax.sub$year %in% c(2004,2005,2006),1,0)
Anova(lmer(offset~drought+(1|s_id),data=frax.sub))
Anova(lmer(flower~drought+(1|s_id),data=frax.sub))
ggplot(frax.sub,aes(as.factor(drought),offset))+geom_boxplot()+ggtitle("Fraxinus excelsior")
ggplot(frax.sub,aes(as.factor(drought),flower))+geom_boxplot()+ggtitle("Fraxinus excelsior")
aes.sub<-dplyr::filter(aes,year %in% c(2004,2005,2006,2008,2009,2010))
aes.sub$drought<-ifelse(aes.sub$year %in% c(2004,2005,2006),1,0)
Anova(lmer(offset~drought+(1|s_id),data=aes.sub))
ggplot(aes.sub,aes(as.factor(drought),offset))+geom_boxplot()+ggtitle("Aesculus")
ggplot(aes.sub,aes(as.factor(drought),flower))+geom_boxplot()+ggtitle("Aesculus")
###
library("raster")
library("remote")
library(reshape2)
d<-frax
calc<-d %>% group_by(s_id) %>% summarise(ave=mean(offset))
d<-dplyr::select(d,s_id,lon,lat)
d<-left_join(d,calc)
d<-d[!duplicated(d), ]
moist<-raster("grids_germany_multi_annual_soil_moist_1991-2010_05.asc") ##Gause Kruger 3
coordinates(d)<- ~lon + lat
proj4string(d) <- CRS("+proj=longlat +datum=WGS84")
p <- spTransform(d, CRS("+proj=tmerc +lat_0=50.625 +lon_0=9.84375, +k=1 +x_0=3559832.734474 +y_0=5610860.187573 +ellps=krass +units=m +no_defs"))
gaas<-coordinates(p)
goo<-as.data.frame(gaas)
goo2<-as.data.frame(d)
colnames(goo)<-c("x","y")
class(d)
goot<-cbind(goo2,goo)
nrow(gaas)
d
###decent projectiontry to extract
foo<-extract(moist, matrix(c(goot$x,goot$y), ncol = 2))
goot$SM<-foo
class(goot)
?lm()
summary(lm(ave~SM,data=goot))
plot(moist)
points(p)
library(rwdw)
library("rdwd")
coordinates(d)
neabySations(11.10000 54.5000)
neabySations(11.10000 ,54.5000)
nearbySations(11.10000 ,54.5000)
?nearbyStations()
nearbySations(54.5000. 11.1)
nearbySations(54.5000, 11.1)
nearbyStations(54.5000, 11.1)
nearbyStations(54.5000, 11.1,radius=5)
link <- selectDWD("Fehmarn", res="mutli_annual", var="soil", per="recent")
crs(moist)
moist
