rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
options(stringsAsFactors = FALSE)
#getOption("device")
options(device="quartz") ###if at arb if not RStudioGD
sessionInfo()
setwd("~/Documents/git/proterant/input")
library("ape")
library("phytools")
library("geiger")
library("gbm")
library("pez")
library(caper)
library(picante)
library("tidyverse")
library(boot)
library("phylolm")
library("ggplot2")
library(arm)
library(ggthemes)
d<-read.csv("hf003-05-mean-ind.csv",header=TRUE)
unique(d$species)
### offset functional
d$offset<-d$l75.jd-d$fopn.jd
###0ffset physiological
d$offset2<-d$bb.jd-d$fbb.jd
###intermediate
d$offset3<-d$bb.jd-d$fopn.jd
sum<-d%>% group_by(species) %>% summarise(avg.offset = mean(offset,na.rm=TRUE))
sum2<-d%>% group_by(species) %>% summarise(avg.offset2 = mean(offset2,na.rm=TRUE))
sum3<-d%>% group_by(species) %>% summarise(avg.offset3 = mean(offset3,na.rm=TRUE))
a<-filter(d, species %in% c("ACRU","ACSA","AMSP" ,"BEAL" ,"BELE" ,"BEPA", "BEPO","FRAM","POTR" ,"QURU" ,"QUVE"))
ggplot(a,aes(year,offset))+geom_point()+facet_wrap(~species)
a1<-filter(a, species %in% c("ACPE","ACRU","ACSA","BEAL" ,"FRAM" ,"QURU"))
ggplot(a1,aes(year,offset))+geom_smooth(method="lm",aes(group=tree.id,col=species),linetype="dashed",se=FALSE,size=0.5)+geom_smooth(method="lm",aes(color=species),size=1.5,se=FALSE)+geom_smooth(method="lm",color="red",size=2,linetype="twodash")+theme_tufte()+scale_color_brewer(palette="Dark2")
ggplot(a1,aes(year,offset2))+geom_smooth(method="lm",aes(group=tree.id,col=species),linetype="dashed",se=FALSE,size=0.5)+geom_smooth(method="lm",aes(color=species),size=1.5,se=FALSE)+geom_smooth(method="lm",color="red",size=2,linetype="twodash")+theme_tufte()+scale_color_brewer(palette="Dark2")
###run a model using harvard forest species combine with michigan trees data
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
setwd("~/Documents/git/proterant/input")
library("ape")
library("phytools")
library("geiger")
library("gbm")
library("pez")
library(caper)
library(picante)
library("tidyverse")
library(boot)
library("phylolm")
library("ggplot2")
library(arm)
library("randomForest")
library(car)
load(file="contmodels.RData")
##read in harvard forest
d<-read.csv("hf003-05-mean-ind.csv",header=TRUE)
product.plot<-grid.arrange(binplot.full,contplot.full, ncol=2)
library(gridExtra)
product.plot
product.plot<-grid.arrange(binplot.full,contplot.full, ncol=2)
binplot.full
binplot.full<-ggplot(HF.bin,aes(estimate,trait))+geom_point(size=2.5,aes(color=category),position=pd)+geom_errorbarh(position=pd,width=0,height=0,aes(xmin=low,xmax=high,color=category))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0),color="black")+xlim(-5,5.5)+theme_bw()+annotate("text", x = 5, y = 5.5, label = "Flowers first",fontface =2)+annotate("text", x = -4.2, y = 5.5, label = "Leaves first",fontface =2)
product.plot<-grid.arrange(binplot.full,contplot.full, ncol=2)
summary(inter.HF)
aic(contplot.full)
AIC(contplot.full)
AIC(fit2)
AIC(fit2.physi)
AIC(funct.HF)
AIC(phys.HF)
AIC(inter.HF)
AIC(fit2)
AIC(fit2.func)
AIC(fit2.physi)
AIC(funct.HF)
AIC(phys.HF)
AIC(inter.HF)
BIC(fit2)
AIC(fit2.physi)
AIC(funct.HF)
AIC(phys.HF)
AIC(inter.HF)
AICc(fit2)
install.packages(sme)
install.packages("sme")
library("sme")
AICc(fit2)
AICc(fit2.func)
AICc(fit2.physi)
AICc(funct.HF)
AICc(phys.HF)
AICc(inter.HF)
AICc(inter.HF)
AIC(inter.HF)
AIC(phys.HF)
AIC(funct.HF)
AIC(fit2.physi)
AIC(fit2)
AIC(fit2.func)
