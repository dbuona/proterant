bootest<-as.data.frame(cent.funct.seed$coefficients)
bootconf<-as.data.frame(cent.funct.seed$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
#jpeg("funct.effect.fill.jpeg")
functplot1<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot1
####c### This is the final analysis file for hysteranthy anaylsis on MTSV as of 3/28/18.
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
setwd("~/Documents/git/proterant/input")
library("ape")
library("phytools")
library("geiger")
library("gbm")
library("pez")
library(caper)
library(picante)
library("tidyverse")
library(boot)
library("phylolm")
library("ggplot2")
library(arm)
library("randomForest")
mich.tree<-read.tree("pruned_for_mich.tre")
mich.data<-read.csv("mich_data_full_clean.csv")
mich.data$dev.time<-NA
mich.data$dev.time<-mich.data$fruiting-mich.data$flo_time
#pro2<-hysteranthy= before, before/with and with
#phylod=0.06 with 101 species hysteranthous
#pro3<- hysteranthy=before only
#D= 0.34 34 sp hysteranthous
###phylo.D###### calculate phylo d.
set.seed(122)
mich.tree$node.label<-NULL
d<-comparative.data(mich.tree,mich.data,name,vcv = TRUE,vcv.dim = 2, na.omit = FALSE)
PhyloD <- phylo.d(d, binvar=pro) ###regular hysteranthy
PhyloD
plot(PhyloD)
Wind<-phylo.d(d, binvar=pol) #-0.48 more phylogenetically conserved that
Wind
tol<-phylo.d(d, binvar=shade_bin)
tol
plot(Wind)
##functionalhysteranthy
PhyloPro2<-phylo.d(d,binvar=pro2)
PhyloPro2
plot(PhyloPro2)
?phylo.d()
plot(PhyloPro2)
#d<-comparative.data(mich.tree,mich.data,name,vcv = TRUE,vcv.dim = 2, na.omit = FALSE)
PhyloPro3<-phylo.d(d,binvar=pro3)
PhyloPro3
plot(Phylo3)
plot(PhyloPro3)
phylosig(mich.tree, mich.data$flo_time, method="lambda", test=TRUE, nsim=999,se=NULL)
phylosig(mich.tree, mich.data$dev.time, method="lambda", test=TRUE, nsim=999)
phylosig(mich.tree, mich.data$heigh_height, method="lambda", test=TRUE, nsim=999)
###Rescale predictors
mich.data$height_cent<-(mich.data$heigh_height-mean(mich.data$heigh_height))/(2*sd(mich.data$heigh_height))
mich.data$fruit_cent<-(mich.data$fruiting-mean(mich.data$fruiting))/(2*sd(mich.data$fruiting))
mich.data$flo_cent<-(mich.data$flo_time-mean(mich.data$flo_time))/(2*sd(mich.data$flo_time))
mich.data$pol_cent<-(mich.data$pol-mean(mich.data$pol))/(2*sd(mich.data$pol))
mich.data$av_fruit_time_cent<-(mich.data$av_fruit_time-mean(mich.data$av_fruit_time))/(2*sd(mich.data$av_fruit_time))
mich.data$dev_time_cent<-(mich.data$dev.time-mean(mich.data$dev.time))/(2*sd(mich.data$dev.time))
###prepare for modeling
mich.data<-  mich.data %>% remove_rownames %>% column_to_rownames(var="name")
mich.data$height10<-mich.data$heigh_height/10
#bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
#bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
#bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
#bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
#bootmich$trait[bootmich$trait=="fruit_cent"]<-"fruit timing"
#bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
#functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
#functplot
############ main analysis plot using seed development as a predictor
cent.funct.seed<-phyloglm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(cent.funct.seed)
bootest<-as.data.frame(cent.funct.seed$coefficients)
bootconf<-as.data.frame(cent.funct.seed$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
#jpeg("funct.effect.fill.jpeg")
functplot1<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
#jpeg("funct.effect.fill.jpeg")
functplot1<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot1
cent.funct.seed.winter<-phyloglm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin+pol:flo_cent,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(cent.funct.seed.winter)
bootest<-as.data.frame(cent.funct.seed.winter$coefficients)
bootconf<-as.data.frame(cent.funct.seed.winter$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol:flo_cent"]<-"Syndrome x Flower phenology"
#jpeg("funct.effect.fill.jpeg")
functplot1<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot1
cent.funct.seed.nophylo<-glm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin,mich.data, family="binomial")
cent.funct.seed.nophylo<-glm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin, data=mich.data, family=binomial())
summary(cent.funct.seed.nophylo)
summary(cent.funct.seed)
cent.funct.seed.nophylo<-glm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin+flo_cent:pol, data=mich.data, family=binomial())
summary(cent.funct.seed.nophylo)
#Whixh species are insect pollinated but not hysteranthous
buggy<-fulter(mich.data, pol=0 & pro2=1)
#Whixh species are insect pollinated but not hysteranthous
buggy<-fulter(mich.data, pol==0 & pro2==1)
#Whixh species are insect pollinated but not hysteranthous
buggy<-filter(mich.data, pol==0 & pro2==1)
View(buggy)
###one more cleaninging tax
mich.data$pol<-if(mich.data$Species="quadrangulata",1,mich.data$pol)
###one more cleaninging tax
mich.data$pol<-if(mich.data$Species=="quadrangulata",1,mich.data$pol)
###one more cleaninging tax
mich.data$pol<-ifelse(mich.data$Species=="quadrangulata",1,mich.data$pol)
#Whixh species are insect pollinated but not hysteranthous
buggy<-filter(mich.data, pol==0 & pro2==1)
View(buggy)
###test sensativity to salix
ambo<-mich.data
mich.data
ambo$pol<-ifelse(ambo$Genus=="Salix",1,ambo$pol)
ambo.cent.phys.seed<-phyloglm(pro3~pol+height_cent+flo_cent+dev_time_cent+shade_bin,ambo, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(ambo.cent.phys.seed)
diff(mich.data,ambo)
View(ambo)
#Whixh species are insect pollinated but not hysteranthous
buggy<-filter(mich.data, pol==0 & pro2==1)
View(buggy)
cent.intermed.seed.winter<-phyloglm(pro~pol+height_cent+flo_cent+dev_time_cent+shade_bin+pol:flo_cent,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(cent.intermed.seed.winter)
bootest1<-as.data.frame(cent.intermed.seed.winter$coefficients)
bootconf1<-as.data.frame(cent.intermed.seed,winter$bootconfint95)
bootconf1<-as.data.frame(t(bootconf1))
bootest1<-rownames_to_column(bootest1, "trait")
bootconf1<-rownames_to_column(bootconf1, "trait")
bootmich1<-full_join(bootconf1,bootest1, by="trait")
colnames(bootmich1)<-c("trait","low","high","estimate")
bootmich1<-dplyr::filter(bootmich1, trait!="alpha")
bootmich1<-dplyr::filter(bootmich1, trait!="(Intercept)")
###names
bootmich1$trait[bootmich1$trait=="shade_bin"]<-"shade tolerance"
bootmich1$trait[bootmich1$trait=="pol"]<-"pollination syndrome"
bootmich1$trait[bootmich1$trait=="height_cent"]<-"max height"
bootmich1$trait[bootmich1$trait=="dev_time_cent"]<-"seed development"
bootmich1$trait[bootmich1$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol:flo_cent"]<-"syndrome x flower phenology"
interplot1<-ggplot(bootmich1,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+theme(axis.text = element_text(size=14, hjust = .5))+xlim(-7,5)+guides(color="none")
bootmich1$trait[bootmich$trait=="pol:flo_cent"]<-"syndrome x flower phenology"
bootmich1$trait[bootmich1$trait=="pol:flo_cent"]<-"syndrome x flower phenology"
bootest1<-rownames_to_column(bootest1, "trait")
bootconf1<-rownames_to_column(bootconf1, "trait")
bootmich1<-full_join(bootconf1,bootest1, by="trait")
bootest1<-as.data.frame(cent.intermed.seed.winter$coefficients)
bootconf1<-as.data.frame(cent.intermed.seed.winter$bootconfint95)
bootconf1<-as.data.frame(t(bootconf1))
bootest1<-rownames_to_column(bootest1, "trait")
bootconf1<-rownames_to_column(bootconf1, "trait")
bootmich1<-full_join(bootconf1,bootest1, by="trait")
colnames(bootmich1)<-c("trait","low","high","estimate")
bootmich1<-dplyr::filter(bootmich1, trait!="alpha")
bootmich1<-dplyr::filter(bootmich1, trait!="(Intercept)")
###names
bootmich1$trait[bootmich1$trait=="shade_bin"]<-"shade tolerance"
bootmich1$trait[bootmich1$trait=="pol"]<-"pollination syndrome"
bootmich1$trait[bootmich1$trait=="height_cent"]<-"max height"
bootmich1$trait[bootmich1$trait=="dev_time_cent"]<-"seed development"
bootmich1$trait[bootmich1$trait=="flo_cent"]<-"flower timing"
bootmich1$trait[bootmich1$trait=="pol:flo_cent"]<-"syndrome x flower phenology"
interplot1<-ggplot(bootmich1,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+theme(axis.text = element_text(size=14, hjust = .5))+xlim(-7,5)+guides(color="none")
interplot1
#Whixh species are insect pollinated but not hysteranthous
buggy<-filter(mich.data, pol==0 & pro2==1)
unique(buggy$Family)
#Whixh species are insect pollinated but not hysteranthous
buggy<-filter(mich.data, pol==0 & pro3==1)
unique(buggy$Family)
View(buggy)
mich.data$pol<-ifelse(mich.data$Genus=="Populus"& mich.data$Species=="nigra",1,mich.data$pol)
unique(buggy$Family)
unique(buggy$Family)
View(buggy)
####c### This is the final analysis file for hysteranthy anaylsis on MTSV as of 3/28/18.
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
setwd("~/Documents/git/proterant/input")
library("ape")
library("phytools")
library("geiger")
library("gbm")
library("pez")
library(caper)
library(picante)
library("tidyverse")
library(boot)
library("phylolm")
library("ggplot2")
library(arm)
library("randomForest")
mich.tree<-read.tree("pruned_for_mich.tre")
mich.data<-read.csv("mich_data_full_clean.csv")
mich.data$dev.time<-NA
mich.data$dev.time<-mich.data$fruiting-mich.data$flo_time
###one more cleaninging tax
mich.data$pol<-ifelse(mich.data$Species=="quadrangulata",1,mich.data$pol)
mich.data$pol<-ifelse(mich.data$Genus=="Populus"& mich.data$Species=="nigra",1,mich.data$pol)
View(mich.data)
#pro2<-hysteranthy= before, before/with and with
#phylod=0.06 with 101 species hysteranthous
#pro3<- hysteranthy=before only
#D= 0.34 34 sp hysteranthous
###phylo.D###### calculate phylo d.
set.seed(122)
mich.tree$node.label<-NULL
d<-comparative.data(mich.tree,mich.data,name,vcv = TRUE,vcv.dim = 2, na.omit = FALSE)
PhyloD <- phylo.d(d, binvar=pro) ###regular hysteranthy
PhyloD
plot(PhyloD)
Wind<-phylo.d(d, binvar=pol) #-0.48 more phylogenetically conserved that
Wind
tol<-phylo.d(d, binvar=shade_bin)
tol
plot(Wind)
##functionalhysteranthy
PhyloPro2<-phylo.d(d,binvar=pro2)
PhyloPro2
plot(PhyloPro2)
#d<-comparative.data(mich.tree,mich.data,name,vcv = TRUE,vcv.dim = 2, na.omit = FALSE)
PhyloPro3<-phylo.d(d,binvar=pro3)
PhyloPro3
plot(PhyloPro3)
###phlosignal for continuous trait
?phylosig()
phylosig(mich.tree, mich.data$flo_time, method="lambda", test=TRUE, nsim=999,se=NULL)
phylosig(mich.tree, mich.data$dev.time, method="lambda", test=TRUE, nsim=999)
phylosig(mich.tree, mich.data$heigh_height, method="lambda", test=TRUE, nsim=999)
###Rescale predictors
mich.data$height_cent<-(mich.data$heigh_height-mean(mich.data$heigh_height))/(2*sd(mich.data$heigh_height))
mich.data$fruit_cent<-(mich.data$fruiting-mean(mich.data$fruiting))/(2*sd(mich.data$fruiting))
mich.data$flo_cent<-(mich.data$flo_time-mean(mich.data$flo_time))/(2*sd(mich.data$flo_time))
mich.data$pol_cent<-(mich.data$pol-mean(mich.data$pol))/(2*sd(mich.data$pol))
mich.data$av_fruit_time_cent<-(mich.data$av_fruit_time-mean(mich.data$av_fruit_time))/(2*sd(mich.data$av_fruit_time))
mich.data$dev_time_cent<-(mich.data$dev.time-mean(mich.data$dev.time))/(2*sd(mich.data$dev.time))
###prepare for modeling
mich.data<-  mich.data %>% remove_rownames %>% column_to_rownames(var="name")
mich.data$height10<-mich.data$heigh_height/10
#bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
#bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
#bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
#bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
#bootmich$trait[bootmich$trait=="fruit_cent"]<-"fruit timing"
#bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
#functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
#functplot
############ main analysis plot using seed development as a predictor
cent.funct.seed<-phyloglm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(cent.funct.seed)
cent.funct.seed.nophylo<-glm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin+flo_cent:pol, data=mich.data, family=binomial())
summary(cent.funct.seed.nophylo)
bootest<-as.data.frame(cent.funct.seed$coefficients)
bootconf<-as.data.frame(cent.funct.seed$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
#jpeg("funct.effect.fill.jpeg")
functplot1<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot1
cent.funct.seed.winter<-phyloglm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin+pol:flo_cent,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(cent.funct.seed.winter)
summary(cent.funct.seed.nophylo)
coef(cent.funct.seed.nophylo)
nophy<-as.data.frame(coef(cent.funct.seed.nophylo))
View(nophy)
phy<-as.data.frame(coef(cent.funct.seed.winter))
phycom<-left_join(phy,nophy)
View(phy)
phy<-as.data.frame(coef(cent.funct.seed.winter))
phy<-  phy %>% remove_rownames %>% column_to_rownames(var="effect")
phy<-  phy %>% remove_rownames %>% column_to_rownames(var="effect")
phy<-as.data.frame(coef(cent.funct.seed.winter))
phy<-  phy %>% remove_rownames %>% column_to_rownames(var="effect")
phy<- phy %>%  rownames_to_column(var="effect")
nophy<- nophy %>%  rownames_to_column(var="effect")n
phycom<-left_join(phy,nophy)
nophy<-as.data.frame(coef(cent.funct.seed.nophylo))
nophy<- nophy %>%  rownames_to_column(var="effect")n
nophy<- nophy %>%  rownames_to_column(var="effect")
phycom<-left_join(phy,nophy)
View(phycom)
cent.funct.seed.winter<-phyloglm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin+pol:flo_cent+dev_time_cent:flo_cent,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(cent.funct.seed.winter)
summary(cent.funct.seed.winter)
bootest<-as.data.frame(cent.funct.seed.winter$coefficients)
bootconf<-as.data.frame(cent.funct.seed.winter$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol:flo_cent"]<-"Syndrome x Flower phenology"
bootmich$trait[bootmich$trait=="flo_cent:dev_time_cent"]<-"development time x Flower phenology"
cent.intermed.seed.winter<-phyloglm(pro~pol+height_cent+flo_cent+dev_time_cent+shade_bin+pol:flo_cent,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
functplot1<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot1
bootest<-as.data.frame(cent.funct.seed.winter$coefficients)
bootconf<-as.data.frame(cent.funct.seed.winter$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
View(bootmich)
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol:flo_cent"]<-"Syndrome x Flower phenology"
bootmich$trait[bootmich$trait=="flo_cent:dev_time_cent"]<-"development time x Flower phenology"
functplot1<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot1
bootmich$trait[bootmich$trait=="dev_time_cent:flo_cent"]<-"development time x Flower phenology"
functplot1<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot1
bootconf<-as.data.frame(cent.funct.seed.winter$bootconfint95)
View(bootconf)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
View(bootmich)
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol:flo_cent"]<-"Syndrome x Flower phenology"
bootmich$trait[bootmich$trait=="flo_cent:dev_time_cent"]<-"development time x Flower phenology"
functplot1<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot1
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,7.5)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,7)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol:flo_cent"]<-"flower phenology x syndrome "
bootmich$trait[bootmich$trait=="flo_cent:dev_time_cent"]<-"flower phenology x development time"
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,7)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot
bootest<-as.data.frame(cent.funct.seed.winter$coefficients)
bootconf<-as.data.frame(cent.funct.seed.winter$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol:flo_cent"]<-"flower phenology x syndrome "
bootmich$trait[bootmich$trait=="flo_cent:dev_time_cent"]<-"flower phenology x development time"
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,7)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot
summary(cent.funct.seed.winter)
cent.funct.seed.winter<-phyloglm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin+pol:flo_cent+dev_time_cent:flo_cent+height_cent:flo_cent,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(cent.funct.seed.winter)
bootest<-as.data.frame(cent.funct.seed.winter$coefficients)
bootconf<-as.data.frame(cent.funct.seed.winter$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol:flo_cent"]<-"flower phenology x syndrome "
bootmich$trait[bootmich$trait=="flo_cent:dev_time_cent"]<-"flower phenology x development time"
bootmich$trait[bootmich$trait=="height_cent:flo_cent"]<-"flower phenology x height"
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,7)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot
cent.funct.seed.winter<-phyloglm(pro2~pol+height_cent+flo_cent+dev_time_cent+shade_bin+pol:flo_cent+dev_time_cent:flo_cent+height_cent:flo_cent+shade_bin:flo_cent,mich.data, mich.tree, method = "logistic_MPLE", btol = 100, log.alpha.bound = 10,
start.beta=NULL, start.alpha=NULL,
boot=599,full.matrix = TRUE)
summary(cent.intermed.seed.winter)
summary(cent.funct.seed.winter)
bootest<-as.data.frame(cent.funct.seed.winter$coefficients)
bootconf<-as.data.frame(cent.funct.seed.winter$bootconfint95)
bootconf<-as.data.frame(t(bootconf))
bootest<-rownames_to_column(bootest, "trait")
bootconf<-rownames_to_column(bootconf, "trait")
bootmich<-full_join(bootconf,bootest, by="trait")
colnames(bootmich)<-c("trait","low","high","estimate")
bootmich<-dplyr::filter(bootmich, trait!="alpha")
bootmich<-dplyr::filter(bootmich, trait!="(Intercept)")
###names
bootmich$trait[bootmich$trait=="shade_bin"]<-"shade tolerance"
bootmich$trait[bootmich$trait=="pol"]<-"pollination syndrome"
bootmich$trait[bootmich$trait=="height_cent"]<-"max height"
bootmich$trait[bootmich$trait=="dev_time_cent"]<-"seed development"
bootmich$trait[bootmich$trait=="flo_cent"]<-"flower timing"
bootmich$trait[bootmich$trait=="pol:flo_cent"]<-"flower phenology x syndrome "
bootmich$trait[bootmich$trait=="flo_cent:dev_time_cent"]<-"flower phenology x development time"
bootmich$trait[bootmich$trait=="height_cent:flo_cent"]<-"flower phenology x height"
bootmich$trait[bootmich$trait=="shade_bin:flo_cent"]<-"flower phenology x tolerance"
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,7)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot
bootmich$trait[bootmich$trait=="flo_cent:shade_bin"]<-"flower phenology x tolerance"
bootmich$trait[bootmich$trait=="flo_cent:shade_bin"]<-"flower phenology x tolerance"
functplot<-ggplot(bootmich,aes(estimate,trait))+geom_point(size=2.5)+geom_segment(aes(y=trait,yend=trait,x=low,xend=high))+theme(panel.border=element_rect(aes(color=blue)))+geom_vline(aes(xintercept=0,color="red"))+xlim(-7,7)+theme(axis.text = element_text(size=14, hjust = .5))+guides(color="none")
functplot
