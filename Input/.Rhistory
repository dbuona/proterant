p
dev.off()
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=3)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5)
p<-p+theme(legend.position="bottom")
p
###run concept.paper.analysis.r
?geom_tiplab2()
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=-.5)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.5)
p<-p+theme(legend.position="bottom")
p
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.2)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.2)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.2(aes(color=hysteranthy)))
p<-p+theme(legend.position="bottom")
p
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.2,(aes(color=hysteranthy)))
jpeg("..//figure/michtreeplot.jpeg",width = 965, height = 1180)
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.2,(aes(color=hysteranthy)))
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.2,(aes(color=hysteranthy)))
p<-p+theme(legend.position="bottom")
p
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(aes(color=hysteranthy)size=2.5,hjust=.2)
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(aes(color=hysteranthy),size=2.5,hjust=.2)
p<-p+theme(legend.position="bottom")
p
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.2)
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.2)
p<-p+theme(legend.position="bottom")
p
p
####This makes a phylogenetic tree with hysteranthy as a trait. 1/10/18
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
setwd("~/Documents/git/proterant/Input")
###libraryies
library("tidyverse")
library("ggplot2")
library(brms)
library(ggthemes)
library("ape")
library("phytools")
library("geiger")
library("gbm")
library("pez")
library(caper)
library(picante)
library(boot)
library("phylolm")
library(ggstance)
library("raster")
library("remote")
library(reshape2)
#if (!requireNamespace("BiocManager", quietly = TRUE))
# install.packages("BiocManager")
#BiocManager::install("ggtree", version = "3.8")
library(ggtree)
setwd("~/Documents/git/proterant/input")
mich.data<-read.csv("datasheets_derived/MTSV_USFS/michdata_final.csv")
mich.tre<-read.tree("datasheets_derived/MTSV_USFS/michtre_final.tre")
silv.data<-read.csv("datasheets_derived/MTSV_USFS/silvdata_final.csv")
silv.tre<-read.tree("datasheets_derived/MTSV_USFS/silvtre_final.tre")
HF.data<-read.csv("HarvardForest/HF.means.data.csv")
HF.tre<-read.tree("HarvardForest/HFtree.tre")
mich.data$synth2[which(mich.data$synth==0)] <- "always seranthous"
mich.data$synth2[which(mich.data$synth==1)] <- "transitional"
mich.data$synth2[which(mich.data$synth==2)] <- "always hysteranthous"
tr <-mich.tre
mich.data<-read.csv("datasheets_derived/MTSV_USFS/michdata_final.csv")
mich.tre<-read.tree("datasheets_derived/MTSV_USFS/michtre_final.tre")
silv.data<-read.csv("datasheets_derived/MTSV_USFS/silvdata_final.csv")
silv.tre<-read.tree("datasheets_derived/MTSV_USFS/silvtre_final.tre")
HF.data<-read.csv("HarvardForest/HF.means.data.csv")
HF.tre<-read.tree("HarvardForest/HFtree.tre")
mich.data$synth<-mich.data$pro2+mich.data$pro3
mich.data$synth2[which(mich.data$synth==0)] <- "always seranthous"
mich.data$synth2[which(mich.data$synth==1)] <- "transitional"
mich.data$synth2[which(mich.data$synth==2)] <- "always hysteranthous"
tr <-mich.tre
par(mar=c(.01,.01,.01,.01))
dd <- data.frame(taxa  = mich.data$name, hysteranthy = mich.data$synth2 )
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.1)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.15)
p<-p+theme(legend.position="bottom")
p
jpeg("..//figure/michtreeplot.jpeg",width = 965, height = 1180)
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.15)
p<-p+theme(legend.position="bottom")
p
dev.off()
silv.data$synth<-silv.data$pro2+silv.data$pro3
silv.data$synth2[which(silv.data$synth==0)] <- "always seranthous"
silv.data$synth2[which(silv.data$synth==1)] <- "transitional"
silv.data$synth2[which(silv.data$synth==2)] <- "always hysteranthous"
par(mar=c(.01,.01,.01,.01))
tr1 <-silv.tre
dd1 <- data.frame(taxa  = silv.data$name, hysteranthy = silv.data$synth2 )
q<-ggtree(tr1,layout="circular")
q <- q %<+% dd1 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=3)
q<-q+theme(legend.position="bottom")
q
q<-ggtree(tr1,layout="circular")
q <- q %<+% dd1 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5)
q<-q+theme(legend.position="bottom")
q
jpeg("..//figure/silvtreeplot.jpeg",width = 870, height = 999)
q<-ggtree(tr1,layout="circular")
q <- q %<+% dd1 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5)
q<-q+theme(legend.position="bottom")
q
dev.off()
jpeg("..//figure/michtreeplot.jpeg",width = 801, height = 960)
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.15)
p<-p+theme(legend.position="bottom")
p
dev.off()
###run concept.paper.analysis.r
?geom_tiplab2()
silv.data$synth<-silv.data$pro2+silv.data$pro3
silv.data$synth2[which(silv.data$synth==0)] <- "always seranthous"
silv.data$synth2[which(silv.data$synth==1)] <- "transitional"
silv.data$synth2[which(silv.data$synth==2)] <- "always hysteranthous"
par(mar=c(.01,.01,.01,.01))
tr1 <-silv.tre
dd1 <- data.frame(taxa  = silv.data$name, hysteranthy = silv.data$synth2 )
jpeg("..//figure/silvtreeplot.jpeg",width = 801, height = 960)
q<-ggtree(tr1,layout="circular")
q <- q %<+% dd1 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5)
q<-q+theme(legend.position="bottom")
q
dev.off()
HF.data$synth<-HF.data$funct.bin+HF.data$phys.bin
HF.data$synth2[which(HF.data$synth==0)] <- "always seranthous"
HF.data$synth2[which(HF.data$synth==1)] <- "transitional"
HF.data$synth2[which(HF.data$synth==2)] <- "always hysteranthous"
HF.data$synth<-HF.data$funct.bin+HF.data$phys.bin
HF.data$synth2[which(HF.data$synth==0)] <- "always seranthous"
HF.data$synth2[which(HF.data$synth==1)] <- "transitional"
HF.data$synth2[which(HF.data$synth==2)] <- "always hysteranthous"
dd2 <- data.frame(taxa  = HF.data$X, hysteranthy = HF.data$synth2 )
y<-ggtree(HF.tre,layout="circular")
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2()
y<-y+theme(legend.position="bottom")
y
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5)
y<-y+theme(legend.position="bottom")
y
y<-ggtree(HF.tre,layout="circular")
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5)
y<-y+theme(legend.position="bottom")
y
par(mar=c(.01,.01,.01,.01))
y<-ggtree(HF.tre,layout="circular")
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5)
y<-y+theme(legend.position="bottom")
y
par(mar=c(.01,.01,.01,.01))
y<-ggtree(HF.tre,layout="circular")
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.1)
y<-y+theme(legend.position="bottom")
y
jpeg("..//figure/HFtreeplot.jpeg",width = 801, height = 960)
y<-ggtree(HF.tre,layout="circular")
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.1)
y<-y+theme(legend.position="bottom")
y
dev.off()
jpeg("..//figure/michtreeplot.jpeg",width = 801, height = 620)
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.15)
p<-p+theme(legend.position="bottom")
p
dev.off()
jpeg("..//figure/silvtreeplot.jpeg",width = 801, height = 620)
q<-ggtree(tr1,layout="circular")
q <- q %<+% dd1 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5)
q<-q+theme(legend.position="bottom")
q
dev.off()
jpeg("..//figure/HFtreeplot.jpeg",width = 801, height = 620)
y<-ggtree(HF.tre,layout="circular")
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(size=2.5,hjust=.1)
y<-y+theme(legend.position="bottom")
y
dev.off()
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(hjust=.15)
p<-p+theme(legend.position="bottom")
p
par(mar=c(1,1,1,1))
dd <- data.frame(taxa  = mich.data$name, hysteranthy = mich.data$synth2 )
jpeg("..//figure/michtreeplot.jpeg",width = 801, height = 620)
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(hjust=.1)
p<-p+theme(legend.position="bottom")
p
dev.off()
p
par(mar=c(0,0,0,0))
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(hjust=.1)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="circular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(hjust=.2)
p<-p+theme(legend.position="bottom")
p
?ggtree()
p<-ggtree(tr,layout="radial")
p
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(hjust=.2)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="fan")
p
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(hjust=.2)
p<-p+theme(legend.position="bottom")
p
dev.off()
p
p<-ggtree(tr,layout="fan",yscale=1)
p
p<-ggtree(tr,layout="fan",yscale=2)
p
p<-ggtree(tr,layout="fan")
p
p<-ggtree(tr,layout="rectagle")
p
p<-ggtree(tr,layout="rectangular")
p
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(hjust=.2)
p<-p+theme(legend.position="bottom")
p
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
p<-p+theme(legend.position="bottom")
p
p
p<-ggtree(tr,layout="rectangular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="rectangular")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=1)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="fan")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=1)
p<-p+theme(legend.position="bottom")
p
p<-ggtree(tr,layout="radial")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=1)
p<-p+theme(legend.position="bottom")
p
p
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
p<-ggtree(tr,layout="radial")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
p<-p+theme(legend.position="bottom")
p
jpeg("..//figure/michtreeplot.jpeg",width = 801, height = 778)
p<-ggtree(tr,layout="radial")
p <- p %<+% dd +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
p<-p+theme(legend.position="bottom")
p
dev.off()
q<-ggtree(tr1,layout="radial")
q <- q %<+% dd1 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
q<-q+theme(legend.position="bottom")
q
jpeg("..//figure/silvtreeplot.jpeg",width = 801, height = 778)
q<-ggtree(tr1,layout="radial")
q <- q %<+% dd1 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
q<-q+theme(legend.position="bottom")
q
dev.off()
jpeg("..//figure/HFtreeplot.jpeg",width = 801, height = 778)
y<-ggtree(HF.tre,layout="radial")
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)+geom_tiplab2(hjust=.1)
y<-y+theme(legend.position="bottom")
y
dev.off()
y
y<-ggtree(HF.tre,layout="radial")
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
y<-y+theme(legend.position="bottom")
y
par(mar=c(.01,.01,.01,.01))
jpeg("..//figure/HFtreeplot.jpeg",width = 801, height = 778)
y<-ggtree(HF.tre,layout="radial")
y <- y %<+% dd2 +geom_tippoint(aes(color=hysteranthy,shape=hysteranthy),size=4)
y<-y+theme(legend.position="bottom")
y
dev.off()
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
nspp <- 15
nsite <- 10
env <- 1:nsite
env <- as.numeric(scale(env))
require(pez)
require(ape)
phy <- rcoal(n=nspp)
Vphy <- vcv(phy)
Vphy <- Vphy/(det(Vphy)^(1/nspp))
Vphy
iD <- t(chol(Vphy))
intercept <- iD %*% rnorm(nspp)
slope <- iD %*% rnorm(nspp)
b <- rep(intercept, each=nsite)
prob <- prob + rep(slope, each=nsite) * rep(env, nspp)
prob <- prob + rnorm(nspp*nsite)
b <- rep(intercept, each=nsite)
prob <- rep(intercept, each=nsite)
prob <- prob + rep(slope, each=nsite) * rep(env, nspp)
prob <- prob + rnorm(nspp*nsite)
pres <- rbinom(length(prob), size=1, prob=exp(prob)/(1+exp(prob)))
prob <- prob + rep(slope, each=nsite) * rep(env, nspp)
prob <- prob + rnorm(nspp*nsite)
pres <- rbinom(length(prob), size=1, prob=exp(prob)/(1+exp(prob)))
ite <- factor(rep(1:nsite, nspp))
species <- factor(rep(1:nspp, each=nsite))
env <- rep(env, nspp)
r.intercept.spp.indep <- list(1, sp = species, covar = diag(nspp))
r.intercept.spp.phy <- list(1, sp = species, covar = Vphy)
r.slope.spp.indep <- list(env, sp = species, covar = diag(nspp))
r.slope.spp.phy <- list(env, sp = species, covar = Vphy)
r.site <- list(1, site = site, covar = diag(nsite))
rnd.effects <- list(r.intercept.spp.indep, r.intercept.spp.phy, r.slope.spp.indep, r.
site <- factor(rep(1:nsite, nspp))
species <- factor(rep(1:nspp, each=nsite))
env <- rep(env, nspp)
r.intercept.spp.indep <- list(1, sp = species, covar = diag(nspp))
r.intercept.spp.phy <- list(1, sp = species, covar = Vphy)
r.slope.spp.indep <- list(env, sp = species, covar = diag(nspp))
r.slope.spp.phy <- list(env, sp = species, covar = Vphy)
r.site <- list(1, site = site, covar = diag(nsite))
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
nspp <- 15
nsite <- 10
env <- 1:nsite
env <- as.numeric(scale(env))
require(pez)
require(ape)
phy <- rcoal(n=nspp)
Vphy <- vcv(phy)
Vphy <- Vphy/(det(Vphy)^(1/nspp))
iD <- t(chol(Vphy))
intercept <- iD %*% rnorm(nspp)
slope <- iD %*% rnorm(nspp)
prob <- rep(intercept, each=nsite)
prob <- prob + rep(slope, each=nsite) * rep(env, nspp)
prob <- prob + rnorm(nspp*nsite)
pres <- rbinom(length(prob), size=1, prob=exp(prob)/(1+exp(prob)))
site <- factor(rep(1:nsite, nspp))
species <- factor(rep(1:nspp, each=nsite))
env <- rep(env, nspp)
r.intercept.spp.indep <- list(1, sp = species, covar = diag(nspp))
r.intercept.spp.phy <- list(1, sp = species, covar = Vphy)
r.slope.spp.indep <- list(env, sp = species, covar = diag(nspp))
r.slope.spp.phy <- list(env, sp = species, covar = Vphy)
r.site <- list(1, site = site, covar = diag(nsite))
rnd.effects <- list(r.intercept.spp.indep, r.intercept.spp.phy, r.slope.spp.indep, r.
modelflag=1
sim.dat<-pglmm.sim(stree(16, "balanced"),nsites=30,modelflag=modelflag,second.env=TRUE,compscale=1)
library(picante)
modelflag=1
sim.dat<-pglmm.sim(stree(16, "balanced"),nsites=30,modelflag=modelflag,second.env=TRUE,compscale=1)
library(picante)
sim.dat<-pglmm.sim(stree(16, "balanced"),nsites=30,modelflag=modelflag,second.env=TRUE,compscale=1)
?pglmm.sim
??pglmm.sim
n <- 100
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
n <- 100
phy <- compute.brlen(rtree(n=n), method = "Grafen", power = 1)
# Generate random data and standardize to have mean 0 and variance 1
X1 <- rTraitCont(phy, model = "BM", sigma = 1)
X1 <- (X1 - mean(X1))/var(X1)
X1
# Simulate binary Y
sim.dat <- data.frame(Y=array(0, dim=n), X1=X1, row.names=phy$tip.label)
sim.dat$Y <- binaryPGLMM.sim(Y ~ X1, phy=phy, data=sim.dat, s2=.5,
B=matrix(c(0,.25),nrow=2,ncol=1), nrep=1)$Y
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
X1
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
summary(phyloglm(Y ~ X1, phy=phy, data=sim.dat))
View(sim.dat)
X1
summary(phyloglm(Y ~ X1, phy=phy, data=sim.dat))
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
sim.dat$Y <- binaryPGLMM.sim(Y ~ X1, phy=phy, data=sim.dat, s2=.5,
B=matrix(c(0,.5),nrow=2,ncol=1), nrep=1)$Y
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
# Simulate binary Y
sim.dat <- data.frame(Y=array(0, dim=n), X1=X1, row.names=phy$tip.label)
sim.dat$Y <- binaryPGLMM.sim(Y ~ X1, phy=phy, data=sim.dat, s2=.5,
B=matrix(c(0,.25),nrow=2,ncol=1), nrep=1)$Y
?binaryPGLMM.sim()
# Simulate binary Y
sim.dat <- data.frame(Y=array(0, dim=n), X1=X1, row.names=phy$tip.label)
sim.dat$Y <- binaryPGLMM.sim(Y ~ X1, phy=phy, data=sim.dat, s2=.5,
B=matrix(c(0,.25),nrow=2,ncol=1), nrep=1)$Y
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
sim.dat$Y <- binaryPGLMM.sim(Y ~ X1, phy=phy, data=sim.dat, s2=.5,
B=matrix(c(1,.25),nrow=2,ncol=1), nrep=1)$Y
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
summary(glm(Y ~ X1, data=sim.dat, family="binomial"))
sim.dat$Y <- binaryPGLMM.sim(Y ~ X1, phy=phy, data=sim.dat, s2=0,
B=matrix(c(1,.25),nrow=2,ncol=1), nrep=1)$Y
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
summary(glm(Y ~ X1, data=sim.dat, family="binomial"))
sim.dat$Y <- binaryPGLMM.sim(Y ~ X1, phy=phy, data=sim.dat, s2=.5,
B=matrix(c(1,.25),nrow=2,ncol=1), nrep=1)$Y
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
summary(glm(Y ~ X1, data=sim.dat, family="binomial"))
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
summary(phyloglm(Y ~ X1, phy=phy, data=sim.dat))
# Fit model
summary(binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat))
# Fit model
binaryPGLMM(Y ~ X1, phy=phy, data=sim.dat)
summary(phyloglm(Y ~ X1, phy=phy, data=sim.dat))
V <- vcv(phy)
V <- V/max(V)
detV <- exp(determinant(V)$modulus[1])
V <- V/detV^(1/n)
invV <- Matrix(solve(V),sparse=T)
?Matrix()
library(Matrix)
V <- vcv(phy)
V <- V/max(V)
detV <- exp(determinant(V)$modulus[1])
V <- V/detV^(1/n)
invV <- Matrix(solve(V),sparse=T)
invV <- Matrix::Matrix(solve(V),sparse=T)
sim.dat$species <- phy$tip.label
rownames(invV) <- sim.dat$species
nitt <- 43000
thin <- 10
burnin <- 3000
prior <- list(R=list(V=1, fix=1), G=list(G1=list(V=1, nu=1000, alpha.mu=0, alpha.V=1)))
summary(MCMCglmm(Y ~ X1, random=~species, ginvers=list(species=invV),
data=sim.dat, slice=TRUE, nitt=nitt, thin=thin, burnin=burnin,
family="categorical", prior=prior, verbose=FALSE))
library(MCMCglmm)
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(MCMCglmm)
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
install.packages(MCMCglmm)
install.packages("MCMCglmm")
library("MCMCglmm")
unloadNamespace("MCMCglmm")
library("MCMCglmm")
unloadNamespace("Matrix")
