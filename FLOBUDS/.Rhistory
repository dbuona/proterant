plot(y~time, data=test.dat)
?rep()
96+50+1447+108+300+500
96+50+1447+108+300+500+400
dat <- data.frame(daytime = as.POSIXct(sprintf("%02i:%02i", 1:23, 2 * (1:23)), format = "%H:%M"),
y = 1:23)
ggplot(dat, aes(daytime, y)) + geom_point() +
scale_x_datetime(labels = function(x) format(x, format = "%H:%M"))
Library(ggplot)
library(ggplot)
library(ggplot2)
dat <- data.frame(daytime = as.POSIXct(sprintf("%02i:%02i", 1:23, 2 * (1:23)), format = "%H:%M"),
y = 1:23)
ggplot(dat, aes(daytime, y)) + geom_point() +
scale_x_datetime(labels = function(x) format(x, format = "%H:%M"))
ggplot(dat, aes(daytime, y)) + geom_point()
ggplot(dat, aes(daytime, y)) + geom_point() +
scale_x_datetime(labels = function(x) format(x, format = "%H:%M"))
ggplot(dat, aes(daytime, y)) + geom_point()
ggplot(dat, aes(daytime, y)) + geom_point() +
scale_x_datetime(labels = function(x) format(x, format = "%H:%M"))
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(ggplot2)
library(ggpubr)
library(gridExtra)
library(grid)
library(gtable)
library(ggthemes)
GDH<-c(376,408,504,472,384,480,480,384)
photo<-c(11,15,15,11,11,11,15,15)
periodicities<-c("coupled","coupled","coupled","coupled","uncoupled","uncoupled","uncoupled","uncoupled")
dat<-data.frame(GDH,photo,periodicities)
x<-c(10.8,10.8,15.2,15.2)
y<-c(382,482,382,482)
xy<-data.frame(x,y)
ploty<-ggplot(dat,(aes(x=photo)))+geom_point(aes(y=GDH,color=periodicities),size=4)+xlim(8,18)+ylim(350,520)+theme_base()+geom_polygon(aes(x=photo,y=GDH,color=periodicities,fill=periodicities),alpha=0.5) +scale_color_manual(values=c("rosybrown","gray10"))+scale_fill_manual(values=c("rosybrown","gray10"))
plotty2<-ploty+geom_rect(dat,mapping=aes(xmin=10.9,xmax=15.1,ymin=382,ymax=482),fill=NA,color="black",size=0.2,linetype="dashed")
plotty2<-plotty2+geom_point(xy,mapping=aes(x,y),shape=8,size=4)+theme(legend.position = "left")
plotty2
xx<-c(1:24)
yy<-rep(25,24)
zz<-rep(15,24)
aa<-c(30,30,30,30,30,30,30,30,30,30,20,20,20,20,20,20,20,20,20,20,20,20,20,20)
bb<-c(30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,20,20,20,20,20,20,20,20)
cc<-c(20,20,20,20,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10)
dd<-c(20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,10,10,10,10,10,10,10,10)
ee<-c(30,30,30,30,30,30,30,30,30,30,30,30,20,20,20,20,20,20,20,20,20,20,20,20)
ff<-c(20,20,20,20,20,20,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10)
dat.simple<-data.frame(xx,yy,zz,aa,bb,cc,dd,ee,ff)
a<-ggplot(dat.simple,aes(xx,yy))+geom_rect(dat.simple,mapping=aes(xmin=10,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,yy),color="red")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("warm/short")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
b<-ggplot(dat.simple,aes(xx,yy))+geom_rect(dat.simple,mapping=aes(xmin=16,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,yy),color="red")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("warm/long")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
c<-ggplot(dat.simple,aes(xx,yy))+geom_rect(dat.simple,mapping=aes(xmin=10,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,zz),color="blue")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("cool/short")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
d<-ggplot(dat.simple,aes(xx,yy))+geom_rect(dat.simple,mapping=aes(xmin=16,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,zz),color="blue")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("cool/long")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
flat<-ggarrange(a, b,c, d, ncol=2, nrow=2, common.legend = TRUE, legend="bottom")
?ggarrange()
aaa<-ggplot(dat.simple,aes(xx,aa))+geom_rect(dat.simple,mapping=aes(xmin=10,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,aa),color="red")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("warm/short")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
bbb<-ggplot(dat.simple,aes(xx,bb))+geom_rect(dat.simple,mapping=aes(xmin=16,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,bb),color="red")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("warm/long")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
ccc<-ggplot(dat.simple,aes(xx,cc))+geom_rect(dat.simple,mapping=aes(xmin=10,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,cc),color="blue")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("cool/short")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
ddd<-ggplot(dat.simple,aes(xx,dd))+geom_rect(dat.simple,mapping=aes(xmin=16,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,dd),color="blue")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("cool/long")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
covarying<-ggarrange(aaa, bbb,ccc, ddd, ncol=2, nrow=2, common.legend = TRUE, legend="bottom")
aaaa<-ggplot(dat.simple,aes(xx,ee))+geom_rect(dat.simple,mapping=aes(xmin=10,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,ee),color="red")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("warm/short")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
bbbb<-ggplot(dat.simple,aes(xx,ee))+geom_rect(dat.simple,mapping=aes(xmin=16,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,ee),color="red")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("warm/long")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
cccc<-ggplot(dat.simple,aes(xx,ff))+geom_rect(dat.simple,mapping=aes(xmin=10,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,ff),color="blue")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("cool/short")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
dddd<-ggplot(dat.simple,aes(xx,ff))+geom_rect(dat.simple,mapping=aes(xmin=16,xmax=24,ymin=0,ymax=30),fill="gray")+theme_base()+geom_line(aes(xx,ff),color="blue")+scale_x_continuous(breaks=c(4,8,12,16,20,24))+scale_y_continuous(breaks=c(0,5,10,15,20,25,30))+ labs(y = "temperature",x = "hours")+ggtitle("cool/long")+theme(plot.title=element_text( hjust=0.5, vjust=0.5))
noncovarying<-ggarrange(aaaa, bbbb,cccc, dddd, ncol=2, nrow=2, common.legend = TRUE, legend="bottom")
grid.arrange(flat,covarying,noncovarying,ncol=3)
grid.rect(width = .5, height = .5, gp = gpar(lwd = 2, col = "black", fill = NA,hjust="left",vjust="top"))
grid.arrange(flat,covarying,noncovarying,ncol=3)
View(dat.simple)
View(dat.simple)
xy
dat
########
temp<-c(12,12,12,12)
light<-c(11,11,15,15)
########
temp<-c(12,12,12,12)
light<-c(11,11,15,15)
treat<-c("warm/short","cool/short","warm/long","warm/long")
dawn<-data.frame(temp,light,treat)
dawn$dawn.offset$(dan$temp-dawn$light)
dawn$dawn.offset$dan$temp-dawn$light
dawn$dawn.offset<-dan$temp-dawn$light
dawn$dawn.offset<-dawn$temp-dawn$light
View(dawn)
require(rstan)
require(geiger)
require(MCMCglmm)
# load data
data(geospiza)
dat <- geospiza$geospiza.data
View(dat)
# create fake sample of trees
tr <- drop.tip(geospiza$geospiza.tree, 'olivacea')
trees <- vector('list', 15)
for(i in 1:15) trees[[i]] <- tr
# get the inverse of the phylovcv, order all to match data
invA <- lapply(trees, function(x) solve(vcv.phylo(x))[row.names(dat), row.names(dat)])
stdat <- list(
N=dim(dat)[1],
y=dat$wingL,
x=dat$tarsusL,
invA=invA,
Ntree=length(invA), #number of trees
p=rep(1/length(invA), length(invA)) #probability of sampling each tree
)
phymodel <- "
data {
int<lower=0> N; //species
int<lower=0> Ntree; //number of trees
vector[N] y;
real x[N];
matrix[N,N] invA[Ntree]; //array of inverse of phylovcv?
}
parameters {
real alpha; //intercept
real beta; //slope
real<lower=0> tau; // scaling factor
simplex[Ntree] theta; //mixture sampling?
}
transformed parameters{
real sigma; //regression error
sigma <- 1/sqrt(tau);
}
model {
vector[N] mu; //multivariate normal mean
//priors
alpha ~ normal(0, 10);
beta ~ normal(0, 10);
sigma ~ uniform(0,1000);
tau ~ gamma(1,1);
theta ~ uniform(0,1);
for(n in 1:N){
mu[n] <- alpha+beta*x[n];
}
y ~ multi_normal_prec(mu, tau*invA[Ntree]);
}
"
phystan = stan(model_name="phylogenetic regression", model_code = phymodel, data=stdat , iter = 1000, chains = 2)
stdat <- list(
N=dim(dat)[1],
y=dat$wingL,
x=dat$tarsusL,
invA=invA,
Ntree=length(invA), #number of trees
p=rep(1/length(invA), length(invA)) #probability of sampling each tree
)
stdat <- list(
N=dim(dat)[1],
y=dat$wingL,
x=dat$tarsusL,
invA=invA,
Ntree=length(invA), #number of trees
p=rep(1/length(invA), length(invA)) #probability of sampling each tree
)
stdat <- list(
N=dim(dat)[1],
y=dat$wingL,
x=dat$tarsusL,
invA=invA,
Ntree=length(invA), #number of trees
p=rep(1/length(invA), length(invA)) #probability of sampling each tree
)
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
slope<-2
hist(rbeta(1000,10+slope*(time),10),col="blue",xlim=c(0,1), add=TRUE)
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
hist(rbeta(1000,10+slope*(time),10),col="blue",xlim=c(0,1), add=TRUE)
hist(rbeta(1000,10+slope*time,10),col="blue",xlim=c(0,1), add=TRUE)
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
hist(rbeta(1000,10+slope*time[i],10),col="blue",xlim=c(0,1), add=TRUE)
for (i in c(length(time))) {
goober<-rbeta(1000,a+slope*time[i],b)
}
b<-10
for (i in c(length(time))) {
goober<-rbeta(1000,intercept+slope*time[i],b)
}
intercept<-10
b<-10
slope<-2
for (i in c(length(time))) {
goober<-rbeta(1000,intercept+slope*time[i],b)
}
time<-seq(1:20)
for (i in c(length(time))) {
goober<-rbeta(1000,intercept+slope*time[i],b)
}
hist(rbeta(goober,col="blue",xlim=c(0,1), add=TRUE)
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
hist(rbeta(goober,col="blue",xlim=c(0,1), add=TRUE)
hist(rbeta(goober,col="blue",xlim=c(0,1), add=TRUE)
)
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
hist(rbeta(goober,col="blue",xlim=c(0,1), add=TRUE)
)
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
hist(rbeta(goober,col="blue", add=TRUE))
hist(rbeta(1000,goober,10),col="blue", add=TRUE))
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
hist(rbeta(1000,goober,10),col="blue", add=TRUE)
for (i in c(length(time))) {
goober<-rbeta(1000,10+slope*time[i],b)
}
goober
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
hist(rbeta(1000,goober,10),col="blue", add=TRUE)
for (i in c(length(time))) {
goober<-rbeta(1000,10+slope*time[i],b)
}
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
hist(rbeta(goober),col="blue", add=TRUE)
hist(goober,col="blue", add=TRUE)
hist(rbeta(1000,10,10),col="red",xlim=c(0,1))
hist(goober,col="blue", add=TRUE)
###TO DO run models without ACE.SAC and BET.ALL to see if figures work better
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(ggplot2)
library(tidyverse)
library("brms")
library(rstan)
library(arm)
library(rstanarm)
library(tibble)
library(ggstance)
library(survival)
library(sur)
library(survminer)
library(ggthemes)
library("Hmisc")
library(brms)
library(broom)
library(RColorBrewer)
options(device = "quartz")
setwd("~/Documents/git/proterant/FLOBUDS")
#load("new_flobud.mods.Rda")
dat<-read.csv("flobudsdata.use.csv",header = TRUE)
dat$Light<-ifelse(dat$Light=="S",0,1)
dat$Force<-ifelse(dat$Force=="C",0,1)
dat<-filter(dat, !GEN.SPA %in% c("AME.SPP","BET.SPP", "BET.ALL","ACE.SAC"))
#####plasticity models for 3 bbch stages
bb.int<-get_prior(budburst.9.~Chill+Light+Force+Chill:Light+Chill:Force+Force:Light,data = dat, family = gaussian())
?get_prior()
mod.bb.int<-brm(budburst.9. ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = dat, family = gaussian(),
iter= 4000,
warmup = 3000)
View(dat)
###check again only complete cases
small<-filter<-(dat,!is.na(flo_day))
###check again only complete cases
small<-filter(dat,!is.na(flo_day))
small<-filter(small,!is.na(budburst.9.))
bb.small<-get_prior(budburst.9.~Chill+Light+Force+Chill:Light+Chill:Force+Force:Light,data = small, family = gaussian())
mod.bb.small<-brm(budburst.9. ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = small, family = gaussian(),
iter= 4000,
warmup = 3000)
summary(bb.small)
summary(mod.bb.small)
flo.int<-get_prior(flo_day~Chill+Light+Force+Chill:Light+Chill:Force+Force:Light,data = dat, family = gaussian())
mod.flo.int<-brm(flo_day~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = dat, family = gaussian(),
iter= 4000,
warmup = 3000)
##########
figpath <- "Plots"
cols <- adjustcolor("indianred3", alpha.f = 0.3)
my.pal <- rep(brewer.pal(n = 10, name = "Paired"), 8)
# display.brewer.all()
alphahere = 0.4
xlab <- "Model estimate of change in phenophase day"
spp <- unique(dat$GEN.SPA)
modelhere <-mod.bb.int
modelhere2<-mod.flo.int
source("exp_muplot_brms.R")
source("prep4plot.R")
jpeg("Plots/flo_buds_figures/bbVflo.jpeg",width=11, height=6,res=300,units = "in")
muplotfx(modelhere,modelhere2, "budburst vs. flowering", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
jpeg("Plots/flo_buds_figures/bbandflo.jpeg",width=11, height=6,res=300,units = "in")
jpeg("/flo_buds_figures/bbandflo.jpeg",width=11, height=6,res=300,units = "in")
muplotfx(modelhere,modelhere2, "budburst vs. flowering", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
dev.new()
muplotfx(modelhere,modelhere2, "budburst vs. flowering", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
muplotfx(modelhere,modelhere2, "budburst vs. flowering", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
sessionInfo()
###TO DO run models without ACE.SAC and BET.ALL to see if figures work better
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(ggplot2)
library(tidyverse)
library("brms")
library(rstan)
library(arm)
library(rstanarm)
library(tibble)
library(ggstance)
library(survival)
library(sur)
library(survminer)
library(ggthemes)
library("Hmisc")
library(brms)
library(broom)
library(RColorBrewer)
#options(device = "quartz")
setwd("~/Documents/git/proterant/FLOBUDS")
#load("new_flobud.mods.Rda")
dat<-read.csv("flobudsdata.use.csv",header = TRUE)
dat$Light<-ifelse(dat$Light=="S",0,1)
dat$Force<-ifelse(dat$Force=="C",0,1)
dat<-filter(dat, !GEN.SPA %in% c("AME.SPP","BET.SPP", "BET.ALL","ACE.SAC"))
#####plasticity models for 3 bbch stages
bb.int<-get_prior(budburst.9.~Chill+Light+Force+Chill:Light+Chill:Force+Force:Light,data = dat, family = gaussian())
mod.bb.int<-brm(budburst.9. ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = dat, family = gaussian(),
iter= 4000,
warmup = 3000)
flo.int<-get_prior(flo_day~Chill+Light+Force+Chill:Light+Chill:Force+Force:Light,data = dat, family = gaussian())
mod.flo.int<-brm(flo_day~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = dat, family = gaussian(),
iter= 4000,
warmup = 3000)
###check again only complete cases
small<-filter(dat,!is.na(flo_day))
small<-filter(small,!is.na(budburst.9.))
bb.small<-get_prior(budburst.9.~Chill+Light+Force+Chill:Light+Chill:Force+Force:Light,data = small, family = gaussian())
mod.bb.small<-brm(budburst.9. ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = small, family = gaussian(),
iter= 7000,
warmup = 6000)
mod.bb.small<-brm(budburst.9. ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = small, family = gaussian(),adapt_delta=0.99,
iter= 7000,
warmup = 6000)
save.image("new_flobud.mods.Rda")
mod.bb.small<-brm(budburst.9. ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = small, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
cols <- adjustcolor("indianred3", alpha.f = 0.3)
my.pal <- rep(brewer.pal(n = 10, name = "Paired"), 8)
# display.brewer.all()
alphahere = 0.4
xlab <- "Model estimate of change in phenophase day"
spp <- unique(dat$GEN.SPA)
modelhere <-mod.bb.int
modelhere2<-mod.bb.small
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "budburst pool vs. complete cases", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
##########
figpath <- "Plots"
cols <- adjustcolor("indianred3", alpha.f = 0.3)
my.pal <- rep(brewer.pal(n = 10, name = "Paired"), 8)
# display.brewer.all()
alphahere = 0.4
xlab <- "Model estimate of change in phenophase day"
spp <- unique(dat$GEN.SPA)
modelhere <-mod.bb.int
modelhere2<-mod.bb.small
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "budburst pool vs. complete cases", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
fo.small<-get_prior(flo_day~Chill+Light+Force+Chill:Light+Chill:Force+Force:Light,data = small, family = gaussian())
mod.fo.small<-brm(flo_day ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = small, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
modelhere <-mod.flo.int
modelhere2<-mod.fo.small
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "flowering pool vs. complete cases", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
View(small)
small$FLS<-small$flo_day-small$budburst.9.
small.fls<-get_prior(FLS~Chill+Light+Force+Chill:Light+Chill:Force+Force:Light,data = small, family = gaussian())
View(small)
small$FLS<-small$budburst.9.-small$flo_day
small.fls<-get_prior(FLS~Chill+Light+Force+Chill:Light+Chill:Force+Force:Light,data = small, family = gaussian())
mod.FLS.small<-brm(FLS ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = small, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
summary(mod.FLS.small)
coef(mod.FLS.small)
modelhere <-mod.FLS.small
modelhere2<-mod.FLS.small
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "FLS change", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
####
unique(dat$GEN.SPA)
hysters<-c("COM.PER","COR.COR","ACE.RUB")
hyst.small<-filter(small, GEN.SPA %in% hysters)
mod.hyst.small<-brm(FLS ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = hyst.small, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
mod.hyst.small
mod.hyst.small<-brm(flo_day ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = hyst.small, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
mod.hyst.small
mod.hyst.small<-brm(FLS ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(1|GEN.SPA),
data = hyst.small, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
mod.hyst.small
ser.small<-filter(small, !GEN.SPA %in% hysters)
mod.ser.small<-brm(FLS ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(1|GEN.SPA),
data = ser.small, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
mod.ser.small
hyst.dat<-filter(dat, GEN.SPA %in% hysters)
mod.hyst.flo<-brm(flo_day ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(1|GEN.SPA),
data = hyst.small, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
mod.ser.flo<-brm(flo_day ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(1|GEN.SPA),
data = ser.dat, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
ser.dat<-filter(dat, !GEN.SPA %in% hysters)
mod.ser.flo<-brm(flo_day ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(1|GEN.SPA),
data = ser.dat, family = gaussian(),control = list(adapt_delta = 0.95),
iter= 7000,
warmup = 6000)
mod.ser.flo
mod.hyst.flo
modelhere <-mod.hyst.flo
modelhere2<-mod.ser.flo
source("prep4plot.R")
mod.hyst.flo<-brm(flo_day ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = hyst.small, family = gaussian(),control = list(adapt_delta = 0.99),
iter= 7000,
warmup = 6000)
mod.hyst.flo
ser.dat<-filter(dat, !GEN.SPA %in% hysters)
mod.ser.flo<-brm(flo_day ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = ser.dat, family = gaussian(),control = list(adapt_delta = 0.99),
iter= 7000,
warmup = 6000)
modelhere <-mod.hyst.flo
modelhere2<-mod.ser.flo
source("prep4plot.R")
modelhere2<-mod.ser.flo
source("prep4plot.R")
source("exp_muplot_brms.R")
spp <- unique(mod.hyst.flo$GEN.SPA)
modelhere <-mod.hyst.flo
modelhere2<-mod.ser.flo
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "Flo_diff_serVShyst", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
muplotfx(modelhere,modelhere2, "Flo_diff_serVShyst", 8, 8, c(0,7), c(-50, 180) , 130, 3.5)
dev.off()
modelhere <-mod.hyst.flo
modelhere2<-mod.hyst.flo
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "Flo_diff_serVShyst", 8, 8, c(0,7), c(-50, 180) , 130, 3.5)
dev.off()
mod.hyst.flo$GEN.SPA
mod.hyst.flo$GEN.SPA
mod.hyst.flo<-brm(flo_day ~ Chill+Light+Force+Chill:Light+Chill:Force+Force:Light+(Chill+Light+Force+Chill:Light+Chill:Force+Force:Light|GEN.SPA),
data = hyst.dat, family = gaussian(),control = list(adapt_delta = 0.99),
iter= 7000,
warmup = 6000)
spp <- unique(hyst.dat$GEN.SPA)
modelhere <-mod.hyst.flo
modelhere2<-mod.hyst.flo
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "Flo_diff_serVShyst", 8, 8, c(0,7), c(-50, 180) , 130, 3.5)
dev.off()
modelhere <-mod.hyst.flo
modelhere2<-mod.ser.flo
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "Flo_diff_serVShyst", 8, 8, c(0,7), c(-50, 180) , 130, 3.5)
modelhere <-mod.hyst.flo
modelhere2<-mod.hyst.flo
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "Flo_diff_serVShyst", 8, 8, c(0,7), c(-50, 180) , 130, 3.5)
dev.off()
muplotfx(modelhere,modelhere2, "Flo_diff_serVShyst", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
muplotfx(modelhere,modelhere2, "Flo_hyst", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
spp <- unique(ser.dat$GEN.SPA)
modelhere <-mod.ser.flo
modelhere2<-mod.ser.flo
source("prep4plot.R")
source("exp_muplot_brms.R")
muplotfx(modelhere,modelhere2, "Flo_ser", 8, 8, c(0,7), c(-50, 120) , 130, 3.5)
dev.off()
