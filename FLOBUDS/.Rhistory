##This is Dan's main analysis. 2018
####data leadin 6 Nov 2018
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(ggplot2)
library(tidyverse)
library("brms")
library(rstan)
library(arm)
library(rstanarm)
library(tibble)
library(ggstance)
library(survival)
library(sur)
library(survminer)
library(ggthemes)
library("Hmisc")
setwd("~/Documents/git/proterant/FLOBUDS")
d<-read.csv("budburst_survival_data.csv")
d$phasebin<-ifelse(d$phase=="Lbb_day.9.",0,1) ## flowering i 1
###z.score to compare with effect interaction of binary phase Model 3
d$p_zz<-d$photoperiod-mean(d$photoperiod)/(2*(sd(d$photoperiod)))
d$f_zz<-d$temp_day-mean(d$temp_day)/(2*(sd(d$temp_day)))
d$c_zz<-d$chilldays-mean(d$chilldays)/(2*(sd(d$chilldays)))
###make predictors binary
d$Light<-ifelse(d$Light=="S",0,1)
d$Force<-ifelse(d$Force=="C",0,1)
d<- transform(d,taxa_num=as.numeric(factor(GEN.SPA)))
###new dataset
d.nosurv<-filter(d,surv==0) ###remove no bursts
d.flo<-filter(d.nosurv,phase=="flo_day.60.")### jsut flowers
d.leaf<-filter(d.nosurv,phase=="Lbb_day.9.") #### jsut leaves
#######################models 0.A and 0.B##################################### many divergent trans not actively in use.
#data.list<-with(d.nosurv,
#       list(y=DOY,
#             sp=taxa_num,
#             chill=Chill,
#              force=Force,
#               photo=Light,
###                n_sp=length(unique(d.flo$taxa_num))))
#mod.flo.1 = stan('stan/winter_2level_floorleaf.stan', data = data.list,
#           iter = 3000, warmup=2200)
#mod.leaf.noint = stan('nointer_2level_flowleaf.stan', data = data.list,
#                 iter = 6000, warmup=5000)
####plot the raw data
d.figure<-filter(d.nosurv !GEN.SPA %in% c("ACE.RUB"))
ggplot(d.nosurv,aes(treatment,DOY,color=phase))+stat_summary()+facet_wrap(~GEN.SPA)+theme_base()
install.packages("ggthemes")
##This is Dan's main analysis. 2018
####data leadin 6 Nov 2018
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(ggplot2)
library(tidyverse)
library("brms")
library(rstan)
library(arm)
library(rstanarm)
library(tibble)
library(ggstance)
library(survival)
library(sur)
library(survminer)
library(ggthemes)
library("Hmisc")
setwd("~/Documents/git/proterant/FLOBUDS")
d<-read.csv("budburst_survival_data.csv")
d$phasebin<-ifelse(d$phase=="Lbb_day.9.",0,1) ## flowering i 1
###z.score to compare with effect interaction of binary phase Model 3
d$p_zz<-d$photoperiod-mean(d$photoperiod)/(2*(sd(d$photoperiod)))
d$f_zz<-d$temp_day-mean(d$temp_day)/(2*(sd(d$temp_day)))
d$c_zz<-d$chilldays-mean(d$chilldays)/(2*(sd(d$chilldays)))
###make predictors binary
d$Light<-ifelse(d$Light=="S",0,1)
d$Force<-ifelse(d$Force=="C",0,1)
d<- transform(d,taxa_num=as.numeric(factor(GEN.SPA)))
###new dataset
d.nosurv<-filter(d,surv==0) ###remove no bursts
d.flo<-filter(d.nosurv,phase=="flo_day.60.")### jsut flowers
d.leaf<-filter(d.nosurv,phase=="Lbb_day.9.") #### jsut leaves
#######################models 0.A and 0.B##################################### many divergent trans not actively in use.
#data.list<-with(d.nosurv,
#       list(y=DOY,
#             sp=taxa_num,
#             chill=Chill,
#              force=Force,
#               photo=Light,
###                n_sp=length(unique(d.flo$taxa_num))))
#mod.flo.1 = stan('stan/winter_2level_floorleaf.stan', data = data.list,
#           iter = 3000, warmup=2200)
#mod.leaf.noint = stan('nointer_2level_flowleaf.stan', data = data.list,
#                 iter = 6000, warmup=5000)
####plot the raw data
d.figure<-filter(d.nosurv !GEN.SPA %in% c("ACE.RUB"))
ggplot(d.nosurv,aes(treatment,DOY,color=phase))+stat_summary()+facet_wrap(~GEN.SPA)+theme_base()
ggplot(d.nosurv,aes(treatment,DOY,color=phase))+stat_summary()+facet_wrap(~GEN.SPA)+theme_base()
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(ggplot2)
library(tidyverse)
library("brms")
library(rstan)
library(arm)
library(rstanarm)
library(tibble)
library(ggstance)
library(survival)
library(sur)
library(survminer)
library(ggthemes)
library("Hmisc")
setwd("~/Documents/git/proterant/FLOBUDS")
load("new_flobud.mods.Rda")
ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
View(goodspfull)
ggplot(goodspfull,aes(Force,DOY))+geom_point(color=phase,shape=Photo),size=0.8)++stat_summary(aes(color=phase,shape=Photo))+facet_grid(Chill~taxa)
ggplot(goodspfull,aes(Force,DOY))+geom_point(aes(color=phase,shape=Photo),size=0.8)+stat_summary(aes(color=phase,shape=Photo))+facet_grid(Chill~taxa)
ggplot(goodspfull,aes(Force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=Photo))+facet_grid(Chill~taxa)
ggplot(goodspfull,aes(Force,DOY))+geom_point(aes(color=phase,shape=Light),size=0.8)+stat_summary(aes(color=phase,shape=Light))+facet_grid(Chill~taxa)
ggplot(goodspfull,aes(Force,DOY))+geom_point(aes(color=phase,shape=as.factor(Light),size=0.8))+stat_summary(aes(color=phase,shape=as.factor(Light)))+facet_grid(Chill~taxa)
ggplot(goodspfull,aes(Force,DOY))+geom_point(aes(color=phase,shape=as.factor(Light),size=0.8))+stat_summary(aes(color=phase,shape=as.factor(Light)))+facet_grid(Chill~taxa)
ggplot(goodspfull,aes(as.factor(Force),DOY))+geom_point(aes(color=phase,shape=as.factor(Light),size=0.8))+stat_summary(aes(color=phase,shape=as.factor(Light)))+facet_grid(Chill~taxa)
ggplot(goodspfull,aes(as.factor(Force),DOY))+geom_point(aes(color=phase,shape=as.factor(Light)),size=0.8)+stat_summary(aes(color=phase,shape=as.factor(Light)))+facet_grid(Chill~taxa)
ggplot(goodspfull,aes(as.factor(Force),DOY))+geom_point(aes(color=phase,shape=as.factor(Light)),size=0.8)+stat_summary(aes(color=phase,shape=as.factor(Light)))+facet_grid(Chill~taxa)+theme_base()
goodspfull$force<-ifelse(goodspfull$Force==1,"High","Low")
goodspfull$photo<-ifelse(goodspfull$photo==1,"Long","Short")
goodspfull$photo<-ifelse(goodspfull$Light==1,"Long","Short")
goodspfull$chill<-ifelse(goodspfull$Chill==1,"Long","Short")
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()
goodspfull<-filter(plot.raw.dat,GEN.SPA %in% c(goodsp))
goodspfull$force<-ifelse(goodspfull$Force==1,"High","Low")
goodspfull$photo<-ifelse(goodspfull$Light==1,"Long","Short")
goodspfull$chill<-ifelse(goodspfull$Chill==1,"Long","Short")
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=photo,shape=phase),size=0.8)+stat_summary(aes(color=photo,shape=phase))+facet_grid(chill~taxa)+theme_base()
goodspfull<-filter(plot.raw.dat,GEN.SPA %in% c(goodsp))
goodspfull$force<-ifelse(goodspfull$Force==1,"High","Low")
goodspfull$photo<-ifelse(goodspfull$Light==1,"Long","Short")
goodspfull$chill<-ifelse(goodspfull$Chill==1,"High chill","Low chill")
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=photo,shape=phase),size=0.8)+stat_summary(aes(color=photo,shape=phase))+facet_grid(chill~taxa)+theme_base()
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()
ggplot(goodspfull,aes(taxa,DOY))+geom_point(aes(color=phase),size=0.8)+stat_summary(aes(color=phase))+facet_grid(chill~photo)+theme_base()
ggplot(goodspfull,aes(taxa,DOY))+geom_point(aes(color=phase,shape=force),size=0.8)+stat_summary(aes(color=phase,shape=foce))+facet_grid(chill~photo)+theme_base()
ggplot(goodspfull,aes(taxa,DOY))+geom_point(aes(color=phase,shape=force),size=0.8)+stat_summary(aes(color=phase,shape=force))+facet_grid(chill~photo)+theme_base()
goodspfull<-filter(plot.raw.dat,GEN.SPA %in% c(goodsp))
goodspfull$force<-ifelse(goodspfull$Force==1,"High","Low")
goodspfull$photo<-ifelse(goodspfull$Light==1,"Long day","Short day")
goodspfull$chill<-ifelse(goodspfull$Chill==1,"High chill","Low chill")
ggplot(goodspfull,aes(taxa,DOY))+geom_point(aes(color=phase,shape=force),size=0.8)+stat_summary(aes(color=phase,shape=force))+facet_grid(chill~photo)+theme_base()
ggplot(goodspfull,aes(taxa,DOY))+geom_point(aes(color=phase,shape=force),size=0.8)+stat_summary(aes(color=phase,shape=force))+facet_grid(chill~photo)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
pdf("Plots/flo_buds_figures/goodsps_rawplots.pdf")
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(taxa,DOY))+geom_point(aes(color=phase,shape=force),size=0.8)+stat_summary(aes(color=phase,shape=force))+facet_grid(chill~photo)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
dev.off()
?pdf()
pdf("Plots/flo_buds_figures/goodsps_rawplots.pdf",width=11, height=8.5)
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(taxa,DOY))+geom_point(aes(color=phase,shape=force),size=0.8)+stat_summary(aes(color=phase,shape=force))+facet_grid(chill~photo)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
dev.off()
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
pdf("Plots/flo_buds_figures/goodsps_rawplots.pdf",width=11, height=8.5)
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
dev.off()
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=taxa,shape=phase),size=0.8)+stat_summary(aes(color=taxa,shape=phase))+facet_grid(chill~photo)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 10)
pdf("Plots/flo_buds_figures/goodsps_rawplots.pdf",width=11, height=8.5)
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 10)
#ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=taxa,shape=phase),size=0.8)+stat_summary(aes(color=taxa,shape=phase))+facet_grid(chill~photo)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
dev.off()
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 12)
pdf("Plots/flo_buds_figures/goodsps_rawplots.pdf",width=11, height=8.5)
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 12)
#ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=taxa,shape=phase),size=0.8)+stat_summary(aes(color=taxa,shape=phase))+facet_grid(chill~photo)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
dev.off()
colnames(bothy)
pd2=position_dodgev(height=0.3)
ggplot(bothy,aes(Estimate,Predictor))+geom_point(aes(color=phase,shape=phase),position=pd2, size=4)+geom_errorbarh(aes(xmin=Q25,xmax=Q75,color=phase),linetype="solid",position=pd2,width=0,size=0.7)+geom_errorbarh(aes(xmin=Q10,xmax=Q90,color=phase),linetype="dotted",position=pd2,width=0,size=0.7)+geom_vline(aes(xintercept=0),color="black")+theme_base()
pdf("Plots/flo_buds_figures/fobb_maineffects.pdf",width=8.5, height=11)
pd2=position_dodgev(height=0.3)
ggplot(bothy,aes(Estimate,Predictor))+geom_point(aes(color=phase,shape=phase),position=pd2, size=4)+geom_errorbarh(aes(xmin=Q25,xmax=Q75,color=phase),linetype="solid",position=pd2,width=0,size=0.7)+geom_errorbarh(aes(xmin=Q10,xmax=Q90,color=phase),linetype="dotted",position=pd2,width=0,size=0.7)+geom_vline(aes(xintercept=0),color="black")+theme_base()
dev.off()
pdf("Plots/flo_buds_figures/fobb_maineffects.pdf",width=8.5, height=8.5)
pd2=position_dodgev(height=0.3)
ggplot(bothy,aes(Estimate,Predictor))+geom_point(aes(color=phase,shape=phase),position=pd2, size=4)+geom_errorbarh(aes(xmin=Q25,xmax=Q75,color=phase),linetype="solid",position=pd2,width=0,size=0.7)+geom_errorbarh(aes(xmin=Q10,xmax=Q90,color=phase),linetype="dotted",position=pd2,width=0,size=0.7)+geom_vline(aes(xintercept=0),color="black")+theme_base()
dev.off()
pdf("Plots/flo_buds_figures/fobb_maineffects.pdf",width=8.5, height=6)
pd2=position_dodgev(height=0.3)
ggplot(bothy,aes(Estimate,Predictor))+geom_point(aes(color=phase,shape=phase),position=pd2, size=4)+geom_errorbarh(aes(xmin=Q25,xmax=Q75,color=phase),linetype="solid",position=pd2,width=0,size=0.7)+geom_errorbarh(aes(xmin=Q10,xmax=Q90,color=phase),linetype="dotted",position=pd2,width=0,size=0.7)+geom_vline(aes(xintercept=0),color="black")+theme_base()
dev.off()
ggplot(goodspfull,aes(phase,DOY))+geom_point(aes(color=force,shape=photo),size=0.8)+stat_summary(aes(color=force,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 12)
ggplot(goodspfull,aes(phase,DOY))+geom_point(aes(color=force,shape=photo),size=0.8)+stat_summary(aes(color=force,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 8)
?base_angle()
?angle()
?theme_base()
ggplot(goodspfull,aes(phase,DOY))+geom_point(aes(color=force,shape=photo),size=0.8)+stat_summary(aes(color=force,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 8)
plot.raw.dat<-gather(dat,phase,DOY,2:4)
plot.raw.dat<-unite(plot.raw.dat,Treatcode,5:7,remove=FALSE)
plot.raw.dat$Treatcode[plot.raw.dat$Treatcode=="1_1_0"]<-"WL28"
plot.raw.dat$Treatcode[plot.raw.dat$Treatcode=="1_1_1"]<-"WL56"
plot.raw.dat$Treatcode[plot.raw.dat$Treatcode=="0_1_0"]<-"CL28"
plot.raw.dat$Treatcode[plot.raw.dat$Treatcode=="0_0_0"]<-"CS28"
plot.raw.dat$Treatcode[plot.raw.dat$Treatcode=="0_0_1"]<-"CS56"
plot.raw.dat$Treatcode[plot.raw.dat$Treatcode=="0_1_1"]<-"CL56"
plot.raw.dat$Treatcode[plot.raw.dat$Treatcode=="1_0_1"]<-"WS56"
plot.raw.dat$Treatcode[plot.raw.dat$Treatcode=="1_0_0"]<-"WS28"
plot.raw.dat$phase[plot.raw.dat$phase=="budburst.9."]<-"budburst"
plot.raw.dat$phase[plot.raw.dat$phase=="leaf_day.15."]<-"expansion"
plot.raw.dat$phase[plot.raw.dat$phase=="flo_day"]<-"flower"
plot.raw.dat.lo<-filter(plot.raw.dat,phase!="budburst")
plot.raw.dat.bb<-filter(plot.raw.dat,phase!="expansion")
goodsp<-c("ACE.PEN","COM.PER","COR.COR","ILE.MUC","PRU.PEN","VAC.COR")
plot.raw.dat.lo<-filter(plot.raw.dat.lo,GEN.SPA %in% c(goodsp) )
plot.raw.dat.bb<-filter(plot.raw.dat.bb,GEN.SPA %in% c(goodsp) )
loraw<-ggplot(plot.raw.dat.lo,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+scale_color_manual(values= c("purple","darkgreen"))+scale_shape_manual(values= c(17,15))+facet_wrap(~GEN.SPA)+theme(axis.text.x = element_text(angle=45))+theme_linedraw()
bbraw<-ggplot(plot.raw.dat.bb,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~GEN.SPA)+scale_color_manual(values= c("purple","darkgreen"))+scale_shape_manual(values= c(17,0))+theme(axis.text.x = element_text(size = .3))+theme_linedraw()
grid.arrange(bbraw,loraw)
plot.raw.dat$taxa<-NA
plot.raw.dat$taxa[plot.raw.dat$GEN.SPA=="ACE.PEN"]<-"A. pensylvanicum"
plot.raw.dat$taxa[plot.raw.dat$GEN.SPA=="COM.PER"]<-"C. peregrina"
plot.raw.dat$taxa[plot.raw.dat$GEN.SPA=="COR.COR"]<-"C. cornuta"
plot.raw.dat$taxa[plot.raw.dat$GEN.SPA=="ILE.MUC"]<-"I. mucronata"
plot.raw.dat$taxa[plot.raw.dat$GEN.SPA=="PRU.PEN"]<-"P. pensylvanica"
plot.raw.dat$taxa[plot.raw.dat$GEN.SPA=="VAC.COR"]<-"V corymbosum"
spp.raw<-ggplot(plot.raw.dat,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+scale_shape_manual(values= c(0,2,6))+facet_wrap(~GEN.SPA)+theme(axis.text.x = element_text(angle=45))
goodspfull<-filter(plot.raw.dat,GEN.SPA %in% c(goodsp))
goodspfull$force<-ifelse(goodspfull$Force==1,"High","Low")
goodspfull$photo<-ifelse(goodspfull$Light==1,"Long day","Short day")
goodspfull$chill<-ifelse(goodspfull$Chill==1,"High chill","Low chill")
ggplot(goodspfull,aes(taxa,DOY))+geom_point(aes(color=phase,shape=force),size=0.8)+stat_summary(aes(color=phase,shape=force))+facet_grid(chill~photo)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
ggplot(goodspfull,aes(phase,DOY))+geom_point(aes(color=force,shape=photo),size=0.8)+stat_summary(aes(color=force,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 8)
pdf("Plots/flo_buds_figures/goodsps_rawplots2.pdf",width=11, height=8.5)
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
#ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 12)
ggplot(goodspfull,aes(phase,DOY))+geom_point(aes(color=force,shape=photo),size=0.8)+stat_summary(aes(color=force,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 8)
dev.off()
pdf("Plots/flo_buds_figures/goodsps_rawplots2.pdf",width=11, height=6)
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
#ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 12)
ggplot(goodspfull,aes(phase,DOY))+geom_point(aes(color=force,shape=photo),size=0.8)+stat_summary(aes(color=force,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 8)
#ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=taxa,shape=phase),size=0.8)+stat_summary(aes(color=taxa,shape=phase))+facet_grid(chill~photo)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
dev.off()
pdf("Plots/flo_buds_figures/goodsps_rawplots2.pdf",width=11, height=6)
#ggplot(goodspfull,aes(Treatcode,DOY))+geom_point(aes(color=phase,shape=phase),size=.8)+stat_summary(aes(color=phase,shape=phase))+facet_wrap(~taxa)+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
#ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=phase,shape=photo),size=0.8)+stat_summary(aes(color=phase,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 12)
ggplot(goodspfull,aes(phase,DOY))+geom_point(aes(color=force,shape=photo),size=0.8)+stat_summary(aes(color=force,shape=photo))+facet_grid(chill~taxa)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Phenophase")+theme_base(base_size = 8)
#ggplot(goodspfull,aes(force,DOY))+geom_point(aes(color=taxa,shape=phase),size=0.8)+stat_summary(aes(color=taxa,shape=phase))+facet_grid(chill~photo)+theme_base()+theme(axis.text.x = element_text(angle=-45,size=8))+ylab("Day of experiment")+xlab("Treatment combination")+theme_base(base_size = 7)
dev.off()
