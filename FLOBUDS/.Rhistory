library("lmerTest")
HF<-read.csv("HarvardForest/hf003-05-mean-ind.csv",header=TRUE)
##Hypothesis 1: variation in FLS is a product of variation in climate between phases
#https://cran.r-project.org/web/packages/chillR/vignettes/hourly_temperatures.html
weather<-read.csv("..//FLOBUDS/data/hf000-01-daily-m.csv",header = TRUE)
weather<-dplyr::select(weather,c("date","airtmax","airtmin"))
weather<-separate(weather,date,c("Year","Month","Day"),sep="-",remove=TRUE)
colnames(weather)<-c("Year","Month","Day","Tmax","Tmin")
sapply(weather,mode) #mode(weather)
weather$Year<-as.numeric(weather$Year)
weather$Month<-as.numeric(weather$Month)
weather$Day<-as.numeric(weather$Day)
unique(weather$Year)
weather<-filter(weather,Year>=1989)
chambercorr<-weather
chambercorr$Tmax<-4
chambercorr$Tmin<-4
unique(chambercorr$Year)
chambercorr<-filter(chambercorr,Year>=2002)
chambercorr<-make_all_day_table(chambercorr)
hourtemps<-stack_hourly_temps(chambercorr, latitude=42.5)$hourtemps ## make hourly
hourtemps$DATE<-ISOdate(hourtemps$Year,hourtemps$Month,hourtemps$Day,hourtemps$Hour)
chillref<-as.data.frame(chilling(hourtemps,Start_JDay=1,End_JDay=60))
chillrefshort<-as.data.frame(chilling(hourtemps,Start_JDay=1,End_JDay=30))
###3 now compare to real data
unique(weather$Year)
weather<-filter(weather,Year>=1989)
weather<-make_all_day_table(weather)
hourtemps<-stack_hourly_temps(weather, latitude=42.5)$hourtemps ## make hourly
hourtemps$DATE<-ISOdate(hourtemps$Year,hourtemps$Month,hourtemps$Day,hourtemps$Hour)
climatt<-as.data.frame(chilling(hourtemps,Start_JDay=365-31-30-15,End_JDay=31+28+31+15)) ##Oct 15-April 15
envtoreal<-data.frame(UtahEst=c(mean(climatt$Utah_Model),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(mean(climatt$Chill_portions),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
View(chillref)
View(envtoreal)
View(chambercorr)
View(chillrefshort)
chillref$Utah_Model
View(chillref)
chillrefshort$Utah_Model
mean(climatt$Utah_Model)
View(climatt)
View(envtoreal)
mean(climatt$Chill_portions)
chillref$Chill_portions
View(chillref)
library(xtable)
xtable(envtoreal)
t(envtoreal)
envtoreal<-data.frame(UtahEst=c(mean(climatt$Utah_Model),(sd(climatt$Utah_Model)),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(mean(climatt$Chill_portions),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
envtoreal<-data.frame(UtahEst=c(mean(climatt$Utah_Model)((sd(climatt$Utah_Model))),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(mean(climatt$Chill_portions),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model)((sd(climatt$Utah_Model)))),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(mean(climatt$Chill_portions),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model),((sd(climatt$Utah_Model)))),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(mean(climatt$Chill_portions),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
View(envtoreal)
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model),((sd(climatt$Utah_Model))),sep=","),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(mean(climatt$Chill_portions),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
View(chillrefshort)
View(envtoreal)
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"))
View(fieldsummarytable)
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
)
"Havard Forest-(Oct 15-April 15)"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions)))
View(fieldsummarytable)
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions)
paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model))
paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours))
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))
"Havard Forest-(Oct 15-April 15)"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions)),)
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest-(Oct 15-April 15)"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))))
View(fieldsummarytable)
xtable(envtoreal,digits = 3)
xtable(envtoreal,digits = 2)
round(fieldsummarytable, digits = 2)
round(fieldsummarytable[, 2:5], digits = 2)
round(fieldsummarytable[,], digits = 2)
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
Havard Forest=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))))
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions)))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions)))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))))
View(fieldsummarytable)
round(fieldsummarytable, digits = 2)
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model),((sd(climatt$Utah_Model))),sep=","),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(paste(mean(climatt$Chill_portions),sd(cllimate),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))))
round(2:4, 2:2], digits = 2) digits = 2)
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model),((sd(climatt$Utah_Model))),sep=","),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(paste(mean(climatt$Chill_portions),sd(cllimate),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))))
round(fieldsummarytable[2:4, 2:2], digits = 2) digits = 2)
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model),((sd(climatt$Utah_Model))),sep=","),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(paste(mean(climatt$Chill_portions),sd(cllimate),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))))
round(fieldsummarytable[2:4, 2:2], digits = 2))
round(fieldsummarytable[2:4, 2:2], digits = 2)
round(fieldsummarytable[, 2:2], digits = 2)
round(fieldsummarytable[4, 2:2], digits = 2)
round(fieldsummarytable[3, 2:2], digits = 2)
fieldsummarytable <- fieldsummarytable %>%
mutate_if(is.numeric, round, digits = 2)
View(fieldsummarytable)
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model),((sd(climatt$Utah_Model))),sep=","),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(paste(mean(climatt$Chill_portions),sd(cllimate),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))),
"Chamber_30_days"=c(chillrefshort$Utah_Model),chillrefshort$Chilling_Hours),chillrefshort$Chill_portions)))
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model),((sd(climatt$Utah_Model))),sep=","),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(paste(mean(climatt$Chill_portions),sd(cllimate),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))),
"Chamber_30_days"=c(chillrefshort$Utah_Model),chillrefshort$Chilling_Hours),chillrefshort$Chill_portions))
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model),((sd(climatt$Utah_Model))),sep=","),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(paste(mean(climatt$Chill_portions),sd(cllimate),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),
paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))),
"Chamber_30_days"=c(chillrefshort$Utah_Model),chillrefshort$Chilling_Hours,chillrefshort$Chill_portions))
envtoreal<-data.frame(UtahEst=c(paste(mean(climatt$Utah_Model),((sd(climatt$Utah_Model))),sep=","),chillref$Utah_Model,chillrefshort$Utah_Model),
CpEst=c(paste(mean(climatt$Chill_portions),sd(cllimate),chillref$Chill_portions,chillrefshort$Chill_portions),
ChEst=c(mean(climatt$Chilling_Hours),chillref$Chilling_Hours,chillrefshort$Chilling_Hours),
treatment=c("HFaverage Oct 15-April 15","60 days chamber","30 days chamber"))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),
paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))),
"Chamber_30_days"=c(chillrefshort$Utah_Model),chillrefshort$Chilling_Hours,chillrefshort$Chill_portions))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),
paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))),
"Chamber_30_days"=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions))
View(fieldsummarytable)
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),
paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))),
"Chamber_30_days"=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
"Chamber_30_days"=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions))
fieldsummarytable<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),
paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))),
"Chamber_30_days"=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
"Chamber_60_days"=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions))
View(fieldsummarytable)
View(fieldsummarytable)
able<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
Havard_Forest=c(paste(mean(climatt$Utah_Model),sd(climatt$Utah_Model)),
paste(mean(climatt$Chilling_Hours),sd(climatt$Chilling_Hours)),
paste(mean(climatt$Chill_portions),sd(climatt$Chill_portions))),
Chamber_30_days=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
Chamber_60_days=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions))
is.num <- sapply(able, is.numeric)
able[is.num] <- lapply(able[is.num], round, 2)
View(able)
able<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
Havard_Forest=c(mean(climatt$Utah_Model),mean(climatt$Chilling_Hours),mean(climatt$Chill_portions),
Chamber_30_days=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
Chamber_60_days=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions)))
is.num <- sapply(able, is.numeric)
able[is.num] <- lapply(able[is.num], round, 2)
View(able)
able<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
Havard_Forest=c(mean(climatt$Utah_Model),mean(climatt$Chilling_Hours),mean(climatt$Chill_portions),
Chamber_30_days=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
Chamber_60_days=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions)))
View(able)
chillrefshort$Chill_portions
c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions)
able<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
Havard_Forest=c(mean(climatt$Utah_Model),mean(climatt$Chilling_Hours),mean(climatt$Chill_portions)),
Chamber_30_days=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
Chamber_60_days=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions))
View(able)
is.num <- sapply(able, is.numeric)
able[is.num] <- lapply(able[is.num], round, 2)
View(able)
able<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
Havard_Forest=c(mean(climatt$Utah_Model),mean(climatt$Chilling_Hours),mean(climatt$Chill_portions)),
sd=c(sd(climatt$Utah_Model),sd(climatt$Chilling_Hours),sd(climatt$Chill_portions)),
Chamber_30_days=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
Chamber_60_days=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions))
is.num <- sapply(able, is.numeric)
able[is.num] <- lapply(able[is.num], round, 2)
View(able)
library(xtable)
xtable(envtoreal)
xtable(able)
able<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
"Havard Forest"=c(mean(climatt$Utah_Model),mean(climatt$Chilling_Hours),mean(climatt$Chill_portions)),
sd=c(sd(climatt$Utah_Model),sd(climatt$Chilling_Hours),sd(climatt$Chill_portions)),
"Chamber 30 days"=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
"Chamber 60 days"=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions))
is.num <- sapply(able, is.numeric)
able[is.num] <- lapply(able[is.num], round, 2)
library(xtable)
xtable(able)
able<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
Havard Forest=c(mean(climatt$Utah_Model),mean(climatt$Chilling_Hours),mean(climatt$Chill_portions)),
sd=c(sd(climatt$Utah_Model),sd(climatt$Chilling_Hours),sd(climatt$Chill_portions)),
Chamber_30_days=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
Chamber_60_days=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions))
able<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
Havard_Forest=c(mean(climatt$Utah_Model),mean(climatt$Chilling_Hours),mean(climatt$Chill_portions)),
sd=c(sd(climatt$Utah_Model),sd(climatt$Chilling_Hours),sd(climatt$Chill_portions)),
Chamber_30_days=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
Chamber_60_days=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions))
able<-data.frame(Estimate=c("Utah Model","Chill Hours", "Dynamic Model"),
Havard_Forest=c(mean(climatt$Utah_Model),mean(climatt$Chilling_Hours),mean(climatt$Chill_portions)),
sd=c(sd(climatt$Utah_Model),sd(climatt$Chilling_Hours),sd(climatt$Chill_portions)),
Chamber_30_days=c(chillrefshort$Utah_Model,chillrefshort$Chilling_Hours,chillrefshort$Chill_portions),
Chamber_60_days=c(chillref$Utah_Model,chillref$Chilling_Hours,chillref$Chill_portions))
is.num <- sapply(able, is.numeric)
able[is.num] <- lapply(able[is.num], round, 2)
write.csv(able,"..//FLOBUDS/input/expfieldcomparisontable.csv",row.names = TRUE)
1440/979
979/1440
new.data<-data.frame(GEN.SPA=rep(unique(small$GEN.SPA),9),
Force=rep(c(0,1),each=45),
Chill=rep(c(.67,1,0),30),
Light=rep(c(1),90))
#####now do flowering a leafing seperately
predictionflo<-predict(mod.flo.int,newdata=new.data,probs = c(.055,.945,.25,.75))
new.data<-data.frame(GEN.SPA=rep(unique(small$GEN.SPA),9),
Force=rep(c(0,1),each=45),
Chill=rep(c(.67,1,0),30),
Light=rep(c(1),90))
new.data<-data.frame(GEN.SPA=rep(unique(dat$GEN.SPA),9),
Force=rep(c(0,1),each=45),
Chill=rep(c(.67,1,0),30),
Light=rep(c(1),90))
###TO DO run models without ACE.SAC and BET.ALL to see if figures work better
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(ggplot2)
library(tidyverse)
library("brms")
library(rstan)
library(arm)
library(rstanarm)
library(tibble)
library(ggstance)
library(survival)
library(sur)
library(survminer)
library(ggthemes)
library("Hmisc")
library(brms)
library(broom)
library(RColorBrewer)
#options(device = "quartz")
setwd("~/Documents/git/proterant/FLOBUDS")
load("new_flobud.mods.Rda")
new.data<-data.frame(GEN.SPA=rep(unique(dat$GEN.SPA),9),
Force=rep(c(0,1),each=45),
Chill=rep(c(.67,1,0),30),
Light=rep(c(1),90))
#####now do flowering a leafing seperately
predictionflo<-predict(mod.flo.int,newdata=new.data,probs = c(.055,.945,.25,.75))
predy<-cbind(new.data,predictionflo)
predy$scenario<-NA
predy$scenario[which(predy$Force==0 & predy$Chill==.6)]<-"historic"
predy$scenario[which(predy$Force==1 & predy$Chill==.6)]<-"warm 5"
predy$scenario[which(predy$Force==1 & predy$Chill== 1)]<-"5+chill"
predy$scenario[which(predy$Force==1 & predy$Chill== 0)]<-"5-chill"
unique(predy$scenario)
predy <- na.omit(predy)
predy %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5", "5-chill", "5+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes())+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0))+facet_wrap(~GEN.SPA)+theme_bw()+geom_hline(yintercept=0)
predictionbb<-predict(mod.bb.int,newdata=new.data,probs = c(.055,.945,.25,.75))
predy2<-cbind(new.data,predictionbb)
predy2$scenario<-NA
predy2$scenario[which(predy2$Force==0 & predy2$Chill==.6)]<-"historic"
predy2$scenario[which(predy2$Force==1 & predy2$Chill==.6)]<-"warm 5"
predy2$scenario[which(predy2$Force==1 & predy2$Chill== 1)]<-"5+chill"
predy2$scenario[which(predy2$Force==1 & predy2$Chill== 0)]<-"5-chill"
unique(predy2$scenario)
predy2 <- na.omit(predy2)
predy$phase<-"flower"
predy2$phase<-"budburst"
predybig<-rbind(predy,predy2)
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=2)+
theme_bw()+scale_color_manual(values=c("darkgreen","hotpink"))
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="fixed",ncol=2)+theme_bw()+scale_color_manual(values=c("darkgreen","hotpink"))
#####now do flowering a leafing seperately
predictionflo<-predict(mod.flo.int,newdata=new.data,probs = c(.055,.945,.25,.75))
predy<-cbind(new.data,predictionflo)
predy$scenario<-NA
predy$scenario[which(predy$Force==0 & predy$Chill==.6)]<-"historic"
predy$scenario[which(predy$Force==0 & predy$Chill==.67)]<-"historic"
predy$scenario[which(predy$Force==1 & predy$Chill==.67)]<-"warm 5"
predy$scenario[which(predy$Force==1 & predy$Chill== 1)]<-"5+chill"
predy$scenario[which(predy$Force==1 & predy$Chill== 0)]<-"5-chill"
unique(predy$scenario)
predy <- na.omit(predy)
predy %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5", "5-chill", "5+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes())+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0))+facet_wrap(~GEN.SPA)+theme_bw()+geom_hline(yintercept=0)
predictionbb<-predict(mod.bb.int,newdata=new.data,probs = c(.055,.945,.25,.75))
predy2<-cbind(new.data,predictionbb)
predy2$scenario<-NA
predy2$scenario[which(predy2$Force==0 & predy2$Chill==.67)]<-"historic"
predy2$scenario[which(predy2$Force==1 & predy2$Chill==.67)]<-"warm 5"
predy2$scenario[which(predy2$Force==1 & predy2$Chill== 1)]<-"5+chill"
predy2$scenario[which(predy2$Force==1 & predy2$Chill== 0)]<-"5-chill"
unique(predy2$scenario)
predy2 <- na.omit(predy2)
predy$phase<-"flower"
predy2$phase<-"budburst"
predybig<-rbind(predy,predy2)
jpeg("Plots/climpredictions.jpeg",width = 6, height = 10, units = 'in', res=300)
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=2)+
theme_bw()+scale_color_manual(values=c("darkgreen","hotpink"))
dev.off()
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=2)+
theme_bw()+scale_color_manual(values=c("darkgreen","hotpink"))
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=2)+
theme_bw()+scale_color_manual(values=c("darkgreen","darkorchid3"))
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=2)+
theme_bw()+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=2)+
ggthemes::theme_base()+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=2)+
ggthemes::theme_base(base_size = 2)+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=2)+
ggthemes::theme_base(base_size = 10)+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
View(predybig)
goo<-filter(predybig,GEN.SPA=COR.COR)
goo<-filter(predybig,GEN.SPA==COR.COR)
goo<-filter(predybig,GEN.SPA=="COR.COR")
plot(scenario,Estiate)
plot(scenario,Estiate,data=goo)
plot(scenario,Estimate,data=goo)
plot(scenario,Estimate,data=goo)
plot(goo$scenario,goo$Estimate)
plot(,goo$Estimate)
plot(goo$Estimate)
goo%>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=2)+
ggthemes::theme_base(base_size = 10)+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
goo%>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+
ggthemes::theme_base(base_size = 10)+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=5)+
ggthemes::theme_base(base_size = 10)+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
jpeg("Plots/climpredictions.jpeg",width = 8, height = 8, units = 'in', res=300)
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=5)+
ggthemes::theme_base(base_size = 10)+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
dev.off()
setEPS()
postscript("Plots/climpredictions.eps",width = 8, height = 8)
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid",alpha=0.8)+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=5)+
ggthemes::theme_base(base_size = 10)+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
dev.off()
setEPS()
postscript("Plots/climpredictions.eps",width = 12, height = 8)
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid")+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted",alpha=0.8)+facet_wrap(~GEN.SPA,scale="free",ncol=5)+
ggthemes::theme_base(base_size = 10)+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
dev.off()
setEPS()
postscript("Plots/climpredictions.eps",width = 12, height = 8)
predybig %>%
arrange(Estimate) %>%
mutate(scenario = factor(scenario, levels=c("historic","warm 5","warm 10", "5-chill","10-chill", "5+chill","10+chill"))) %>%
ggplot(aes(scenario,Estimate))+geom_point(aes(color=phase,shape=phase),size=2.5)+geom_errorbar(aes(ymin=Q25,ymax=Q75,width=0,color=phase),linetype="solid")+geom_errorbar(aes(ymin=Q5.5,ymax=Q94.5,width=0,color=phase),linetype="dotted")+facet_wrap(~GEN.SPA,scale="free",ncol=5)+
ggthemes::theme_base(base_size = 10)+scale_color_manual(values=c("darkgreen","darkorchid3"))+scale_shape_manual(values=c(17,19))
dev.off()
save.image("new_flobud.mods.Rda")
## Load VGAM library. This has convenient functions for generating beta-binomial random variables
## and for fitting beta-binomial distributions to data via maximum likelihood estimation
## install.packages("VGAM")
library(VGAM)
install.packages("VGAM")
## Load VGAM library. This has convenient functions for generating beta-binomial random variables
## and for fitting beta-binomial distributions to data via maximum likelihood estimation
## install.packages("VGAM")
library(VGAM)
## Load VGAM library. This has convenient functions for generating beta-binomial random variables
## and for fitting beta-binomial distributions to data via maximum likelihood estimation
## install.packages("VGAM")
library(VGAM)
## Set parameter values
param <- list(s1 = 2,
s2 = 7,
trials = 10)
## Generate samples from (unshifted) beta-binomial distribution
set.seed(20200329) # set seed for reproducibility
nsamples <- 2000 # how many samples?
sim.stor <- rbetabinom.ab(n = nsamples, # use VGAM generator
size = param[["trials"]],
shape1 = param[["s1"]],
shape2 = param[["s2"]])
## Plot simulated data
plot(NA,
xlim = c(0, param[["trials"]] + 7),
ylim = c(0, .25),
xlab = "Day of flowering",
ylab = "Proportion",
)
tab.sim <- table(sim.stor)
points((tab.sim / nsamples) ~ c(0:10), type = "l", col = "blue")
points((tab.sim / nsamples) ~ c(0:10), type = "p", pch = 16, col = "blue", cex = 2)
## Load rstan library
library(rstan)
options(mc.cores = parallel::detectCores())
## Put simulated data into list for stan
germ.stan <- list(N = length(sim.stor),
G = sim.stor,
D = 8,
Days = c(max(sim.stor):(max(sim.stor)+7)))
## Plot simulated data
plot(NA,
xlim = c(0, param[["trials"]] + 7),
ylim = c(0, .25),
xlab = "Day of flowering",
ylab = "Proportion",
)
tab.sim <- table(sim.stor)
points((tab.sim / nsamples) ~ c(0:10), type = "l", col = "blue")
points((tab.sim / nsamples) ~ c(0:10), type = "p", pch = 16, col = "blue", cex = 2)
